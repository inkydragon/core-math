/* Generate special cases for asinpi testing.

Copyright (c) 2022-2023 Paul Zimmermann, Inria.

This file is part of the CORE-MATH project
(https://core-math.gitlabpages.inria.fr/).

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
*/

#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <string.h>
#include <fenv.h>
#include <math.h>
#include <sys/types.h>
#include <unistd.h>
#include <omp.h>

int ref_init (void);
int ref_fesetround (int);

double cr_asinpi (double);
double ref_asinpi (double);

int rnd1[] = { FE_TONEAREST, FE_TOWARDZERO, FE_UPWARD, FE_DOWNWARD };

int rnd = 0;
int verbose = 0;

static inline uint64_t
asuint64 (double f)
{
  union
  {
    double f;
    uint64_t i;
  } u = {f};
  return u.i;
}

static void
check (double x)
{
  double y1 = ref_asinpi (x);
  fesetround (rnd1[rnd]);
  double y2 = cr_asinpi (x);
  if (asuint64 (y1) != asuint64 (y2))
  {
    printf ("FAIL x=%la ref=%la z=%la\n", x, y1, y2);
    fflush (stdout);
    exit (1);
  }
}

#define N_WORST 1027

/* worst cases in [2^-1020,2^-1019) */
static double T[N_WORST] = {
0x1.019cd2054f211p-1020,
0x1.00f0169407c3ap-1020,
0x1.00435b22c0663p-1020,
0x1.021f30aa295fap-1020,
0x1.01727538e2023p-1020,
0x1.00c5b9c79aa4cp-1020,
0x1.0018fe5653475p-1020,
0x1.01f4d3ddbc40cp-1020,
0x1.0148186c74e35p-1020,
0x1.0323edf3dddccp-1020,
0x1.02773282967f5p-1020,
0x1.04530809ff78cp-1020,
0x1.02cbec1b70bd1p-1020,
0x1.03fb063192591p-1020,
0x1.034e4ac04afbap-1020,
0x1.02a18f4f039e3p-1020,
0x1.047d64d66c97ap-1020,
0x1.03d0a965253a3p-1020,
0x1.05ac7eec8e33ap-1020,
0x1.04ffc37b46d63p-1020,
0x1.062edd9168723p-1020,
0x1.04a7c1a2d9b68p-1020,
0x1.058222202114cp-1020,
0x1.05d6dbb8fb528p-1020,
0x1.052a2047b3f51p-1020,
0x1.06593a5dd5911p-1020,
0x1.08350fe53e8a8p-1020,
0x1.07885473f72d1p-1020,
0x1.06db9902afcfap-1020,
0x1.08b76e8a18c91p-1020,
0x1.080ab318d16bap-1020,
0x1.075df7a78a0e3p-1020,
0x1.088d11bdabaa3p-1020,
0x1.0705f5cf1cee8p-1020,
0x1.07b2b140644bfp-1020,
0x1.08e1cb5685e7fp-1020,
0x1.0abda0ddeee16p-1020,
0x1.0a10e56ca783fp-1020,
0x1.096429fb60268p-1020,
0x1.0a93441181c28p-1020,
0x1.0939cd2ef307ap-1020,
0x1.0b3fff82c91ffp-1020,
0x1.09e688a03a651p-1020,
0x1.0b15a2b65c011p-1020,
0x1.0a68e74514a3ap-1020,
0x1.0b98015b363fap-1020,
0x1.0d73d6e29f391p-1020,
0x1.0becbaf4107d6p-1020,
0x1.0c6f1998eabbfp-1020,
0x1.0bc25e27a35e8p-1020,
0x1.0d1bd50a32196p-1020,
0x1.0cf1783dc4fa8p-1020,
0x1.0c44bccc7d9d1p-1020,
0x1.0e209253e6968p-1020,
0x1.0d9e33af0c57fp-1020,
0x1.0dc8907b7976dp-1020,
0x1.0f4fac6a08328p-1020,
0x1.0ea2f0f8c0d51p-1020,
0x1.0ffc67db4f8ffp-1020,
0x1.0ef7aa919b12dp-1020,
0x1.0e4aef2053b56p-1020,
0x1.0ecd4dc52df3fp-1020,
0x1.0f7a093675516p-1020,
0x1.10a9234c96ed6p-1020,
0x1.1026c4a7bcaedp-1020,
0x1.107ec68029ce8p-1020,
0x1.112b81f1712bfp-1020,
0x1.11d83d62b8896p-1020,
0x1.10d38019040c4p-1020,
0x1.11ade0964b6a8p-1020,
0x1.1155debdde4adp-1020,
0x1.12029a2f25a84p-1020,
0x1.125a9c0792c7fp-1020,
0x1.1331b44547444p-1020,
0x1.1284f8d3ffe6dp-1020,
0x1.13075778da256p-1020,
0x1.1460ce5b68e04p-1020,
0x1.13b412ea2182dp-1020,
0x1.1389b61db463fp-1020,
0x1.1436718efbc16p-1020,
0x1.13de6fb68ea1bp-1020,
0x1.14b8d033d5fffp-1020,
0x1.150d89ccb03dbp-1020,
0x1.14e32d00431edp-1020,
0x1.163ca3e2d1d9bp-1020,
0x1.158fe8718a7c4p-1020,
0x1.15658ba51d5d6p-1020,
0x1.1612471664badp-1020,
0x1.16e95f5419372p-1020,
0x1.16bf0287ac184p-1020,
0x1.1694a5bb3ef96p-1020,
0x1.18707b42a7f2dp-1020,
0x1.17c3bfd160956p-1020,
0x1.176bbdf8f375bp-1020,
0x1.1818796a3ad32p-1020,
0x1.1741612c8656dp-1020,
0x1.17ee1c9dcdb44p-1020,
0x1.189ad80f1511bp-1020,
0x1.191d36b3ef504p-1020,
0x1.194793805c6f2p-1020,
0x1.1af90c3b5849bp-1020,
0x1.199f9558c98edp-1020,
0x1.1a4c50ca10ec4p-1020,
0x1.19f44ef1a3cc9p-1020,
0x1.1aceaf6eeb2adp-1020,
0x1.19c9f22536adbp-1020,
0x1.1a76ad967e0b2p-1020,
0x1.1b236907c5689p-1020,
0x1.1b7b6ae032884p-1020,
0x1.1d819d3408a09p-1020,
0x1.1cd4e1c2c1432p-1020,
0x1.1c28265179e5bp-1020,
0x1.1caa84f654244p-1020,
0x1.1ba5c7ac9fa72p-1020,
0x1.1d5740679b81bp-1020,
0x1.1c52831de7049p-1020,
0x1.1e2e58a54ffep-1020,
0x1.1cff3e8f2e62p-1020,
0x1.1dd99f0c75c04p-1020,
0x1.1e03fbd8e2df2p-1020,
0x1.1f5d72bb719ap-1020,
0x1.1eb0b74a2a3c9p-1020,
0x1.200a2e2cb8f77p-1020,
0x1.1e865a7dbd1dbp-1020,
0x1.1f3315ef047b2p-1020,
0x1.1fdfd1604bd89p-1020,
0x1.1fb57493deb9bp-1020,
0x1.20e48eaa0055bp-1020,
0x1.208c8cd19336p-1020,
0x1.21394842da937p-1020,
0x1.2062300526172p-1020,
0x1.210eeb766d749p-1020,
0x1.21bba6e7b4d2p-1020,
0x1.21914a1b47b32p-1020,
0x1.223e058c8f109p-1020,
0x1.22686258fc2f7p-1020,
0x1.236d1fa2b0ac9p-1020,
0x1.22c06431694f2p-1020,
0x1.23151dca438cep-1020,
0x1.23ef7e478aeb2p-1020,
0x1.22eac0fdd66ep-1020,
0x1.249c39b8d2489p-1020,
0x1.23977c6f1dcb7p-1020,
0x1.244437e06528ep-1020,
0x1.2419db13f80ap-1020,
0x1.25f5b09b61037p-1020,
0x1.2548f52a19a6p-1020,
0x1.24c696853f677p-1020,
0x1.25cb53cef3e49p-1020,
0x1.26780f403b42p-1020,
0x1.257351f686c4ep-1020,
0x1.26200d67ce225p-1020,
0x1.26a26c0ca860ep-1020,
0x1.26fa6de515809p-1020,
0x1.287e4194115a5p-1020,
0x1.2724cab1829f7p-1020,
0x1.27d18622c9fcep-1020,
0x1.27a729565cdep-1020,
0x1.2853e4c7a43b7p-1020,
0x1.274f277defbe5p-1020,
0x1.2900a038eb98ep-1020,
0x1.28d6436c7e7ap-1020,
0x1.292afd0558b7cp-1020,
0x1.2a5a171b7a53cp-1020,
0x1.29ad5baa32f65p-1020,
0x1.2982feddc5d77p-1020,
0x1.2a2fba4f0d34ep-1020,
0x1.2adc75c054925p-1020,
0x1.2ab218f3e7737p-1020,
0x1.2b5ed4652ed0ep-1020,
0x1.2b8931319befcp-1020,
0x1.2a055d82a016p-1020,
0x1.2c35eca2e34d3p-1020,
0x1.2d104d202aab7p-1020,
0x1.2dbd08917208ep-1020,
0x1.2c0b8fd6762e5p-1020,
0x1.2cb84b47bd8bcp-1020,
0x1.2be1330a090f7p-1020,
0x1.2d6506b904e93p-1020,
0x1.2c8dee7b506cep-1020,
0x1.2d3aa9ec97ca5p-1020,
0x1.2e69c402b9665p-1020,
0x1.2f98de18db025p-1020,
0x1.2eec22a793a4ep-1020,
0x1.2de7655ddf27cp-1020,
0x1.2e9420cf26853p-1020,
0x1.2f40dc406de2ap-1020,
0x1.2f167f7400c3cp-1020,
0x1.2fc33ae548213p-1020,
0x1.30f254fb69bd3p-1020,
0x1.301b3cbdb540ep-1020,
0x1.3045998a225fcp-1020,
0x1.30c7f82efc9e5p-1020,
0x1.3174b3a043fbcp-1020,
0x1.32216f118b593p-1020,
0x1.306ff6568f7eap-1020,
0x1.31f712451e3a5p-1020,
0x1.319f106cb11aap-1020,
0x1.324bcbddf8781p-1020,
0x1.337ae5f41a141p-1020,
0x1.32ce2a82d2b6ap-1020,
0x1.32a3cdb66597cp-1020,
0x1.33508927acf53p-1020,
0x1.33fd4498f452ap-1020,
0x1.33262c5b3fd65p-1020,
0x1.33d2e7cc8733cp-1020,
0x1.34aa000a3bb01p-1020,
0x1.347fa33dce913p-1020,
0x1.36311bf8ca6bcp-1020,
0x1.3556bb7b830d8p-1020,
0x1.352c5eaf15eeap-1020,
0x1.350201e2a8cfcp-1020,
0x1.35d91a205d4c1p-1020,
0x1.3685d591a4a98p-1020,
0x1.35aebd53f02d3p-1020,
0x1.365b78c5378aap-1020,
0x1.36ddd76a11c93p-1020,
0x1.38b9acf17ac2ap-1020,
0x1.380cf18033653p-1020,
0x1.370834367ee81p-1020,
0x1.37b4efa7c6458p-1020,
0x1.3861ab190da2fp-1020,
0x1.378a92db5926ap-1020,
0x1.38374e4ca0841p-1020,
0x1.393c0b9655013p-1020,
0x1.38e409bde7e18p-1020,
0x1.3a958278e3bc1p-1020,
0x1.3b423dea2b198p-1020,
0x1.39e8c7079c5eap-1020,
0x1.3990c52f2f3efp-1020,
0x1.39666862c2201p-1020,
0x1.3b17e11dbdfaap-1020,
0x1.3a1323d4097d8p-1020,
0x1.3abfdf4550dafp-1020,
0x1.3b6c9ab698386p-1020,
0x1.3bc49c8f05581p-1020,
0x1.3c7158004cb58p-1020,
0x1.3d1e13719412fp-1020,
0x1.3dcacee2db706p-1020,
0x1.3c46fb33df96ap-1020,
0x1.3beef95b7276fp-1020,
0x1.3cf3b6a526f41p-1020,
0x1.3c9bb4ccb9d46p-1020,
0x1.3da072166e518p-1020,
0x1.3e778a5422cddp-1020,
0x1.3d48703e0131dp-1020,
0x1.3e4d2d87b5aefp-1020,
0x1.3ef9e8f8fd0c6p-1020,
0x1.3fa6a46a4469dp-1020,
0x1.3e22d0bb48901p-1020,
0x1.3ecf8c2c8fed8p-1020,
0x1.3f7c479dd74afp-1020,
0x1.3f51ead16a2c1p-1020,
0x1.412dc058d3258p-1020,
0x1.3ffea642b1898p-1020,
0x1.40535fdb8bc74p-1020,
0x1.4029030f1ea86p-1020,
0x1.40d5be806605dp-1020,
0x1.418279f1ad634p-1020,
0x1.40ab61b3f8e6fp-1020,
0x1.41581d2540446p-1020,
0x1.425cda6ef4c18p-1020,
0x1.4204d89687a1dp-1020,
0x1.41da7bca1a82fp-1020,
0x1.43b65151837c6p-1020,
0x1.430995e03c1efp-1020,
0x1.42b19407ceff4p-1020,
0x1.4287373b61e06p-1020,
0x1.435e4f79165cbp-1020,
0x1.4438aff65dbafp-1020,
0x1.4333f2aca93ddp-1020,
0x1.43e0ae1df09b4p-1020,
0x1.448d698f37f8bp-1020,
0x1.44630cc2cad9dp-1020,
0x1.463ee24a33d34p-1020,
0x1.44e56b67a5186p-1020,
0x1.459226d8ec75dp-1020,
0x1.4567ca0c7f56fp-1020,
0x1.450fc83412374p-1020,
0x1.4614857dc6b46p-1020,
0x1.45bc83a55994bp-1020,
0x1.46c140ef0e11dp-1020,
0x1.46693f16a0f22p-1020,
0x1.46eb9dbb7b30bp-1020,
0x1.476dfc60556f4p-1020,
0x1.48c77342e42a2p-1020,
0x1.481ab7d19cccbp-1020,
0x1.47439f93e8506p-1020,
0x1.47f05b052faddp-1020,
0x1.489d1676770b4p-1020,
0x1.4798592cc28e2p-1020,
0x1.4872b9aa09ec6p-1020,
0x1.491f751b5149dp-1020,
0x1.4949d1e7be68bp-1020,
0x1.4aa348ca4d239p-1020,
0x1.49f68d5905c62p-1020,
0x1.49cc308c98a74p-1020,
0x1.49742eb42b879p-1020,
0x1.4a78ebfde004bp-1020,
0x1.4b7da9479481dp-1020,
0x1.4a4e8f3172e5dp-1020,
0x1.4b25a76f27622p-1020,
0x1.4afb4aa2ba434p-1020,
0x1.4bd262e06ebf9p-1020,
0x1.4c7f1e51b61dp-1020,
0x1.4ba8061401a0bp-1020,
0x1.4d597ecefd7b4p-1020,
0x1.4c54c18548fe2p-1020,
0x1.4d017cf6905b9p-1020,
0x1.4c2a64b8dbdf4p-1020,
0x1.4cd7202a233cbp-1020,
0x1.4eb2f5b18c362p-1020,
0x1.4dae3867d7b9p-1020,
0x1.4d83db9b6a9a2p-1020,
0x1.4e063a4044d8bp-1020,
0x1.4e8898e51f174p-1020,
0x1.4f3554566674bp-1020,
0x1.4e30970cb1f79p-1020,
0x1.4fe20fc7add22p-1020,
0x1.4edd527df955p-1020,
0x1.4f8a0def40b27p-1020,
0x1.4f5fb122d3939p-1020,
0x1.513b86aa3c8dp-1020,
0x1.500c6c941af1p-1020,
0x1.508ecb38f52f9p-1020,
0x1.50646e6c8810bp-1020,
0x1.511129ddcf6e2p-1020,
0x1.51bde54f16cb9p-1020,
0x1.50b92805624e7p-1020,
0x1.51938882a9acbp-1020,
0x1.51e8421b83ea7p-1020,
0x1.524043f3f10a2p-1020,
0x1.526aa0c05e29p-1020,
0x1.53c417a2ece3ep-1020,
0x1.53175c31a5867p-1020,
0x1.5294fd8ccb47ep-1020,
0x1.52ecff6538679p-1020,
0x1.5399bad67fc5p-1020,
0x1.54467647c7227p-1020,
0x1.536f5e0a12a62p-1020,
0x1.541c197b5a039p-1020,
0x1.549e782034422p-1020,
0x1.54f331b90e7fep-1020,
0x1.559fed2a55dd5p-1020,
0x1.567a4da79d3b9p-1020,
0x1.54c8d4eca161p-1020,
0x1.5575905de8be7p-1020,
0x1.56224bcf301bep-1020,
0x1.554b33917b9f9p-1020,
0x1.55f7ef02c2fdp-1020,
0x1.56cf074077795p-1020,
0x1.56a4aa740a5a7p-1020,
0x1.57a967bdbed79p-1020,
0x1.5856232f0635p-1020,
0x1.5902dea04d927p-1020,
0x1.575165e551b7ep-1020,
0x1.57270918e499p-1020,
0x1.57fe215699155p-1020,
0x1.58aadcc7e072cp-1020,
0x1.57d3c48a2bf67p-1020,
0x1.58807ffb7353ep-1020,
0x1.592d3b6cbab15p-1020,
0x1.59853d4527d1p-1020,
0x1.5a31f8b66f2e7p-1020,
0x1.5adeb427b68bep-1020,
0x1.59d9f6de020ecp-1020,
0x1.59af9a1194efep-1020,
0x1.5ab4575b496dp-1020,
0x1.5a5c5582dc4d5p-1020,
0x1.5c382b0a4546cp-1020,
0x1.5b8b6f98fde95p-1020,
0x1.5b6112cc90ca7p-1020,
0x1.5b0910f423aacp-1020,
0x1.5c0dce3dd827ep-1020,
0x1.5bb5cc656b083p-1020,
0x1.5cba89af1f855p-1020,
0x1.5d67452066e2cp-1020,
0x1.5c902ce2b2667p-1020,
0x1.5d3ce853f9c3ep-1020,
0x1.5ce4e67b8ca43p-1020,
0x1.5ec0bc02f59dap-1020,
0x1.5e140091ae403p-1020,
0x1.5dbf46f8d4027p-1020,
0x1.5de9a3c541215p-1020,
0x1.5e965f36887ecp-1020,
0x1.5f431aa7cfdc3p-1020,
0x1.5e6c026a1b5fep-1020,
0x1.5fefd6191739ap-1020,
0x1.5f18bddb62bd5p-1020,
0x1.5fc5794caa1acp-1020,
0x1.5f9b1c803cfbep-1020,
0x1.6176f207a5f55p-1020,
0x1.60ca36965e97ep-1020,
0x1.607234bdf1783p-1020,
0x1.6047d7f184595p-1020,
0x1.611ef02f38d5ap-1020,
0x1.60f49362cbb6cp-1020,
0x1.61cbaba080331p-1020,
0x1.61a14ed413143p-1020,
0x1.624e0a455a71ap-1020,
0x1.6223ad78ed52cp-1020,
0x1.62a60c1dc7915p-1020,
0x1.63ff8300564c3p-1020,
0x1.6352c78f0eeecp-1020,
0x1.62fac5b6a1cf1p-1020,
0x1.62d068ea34b03p-1020,
0x1.63d52633e92d5p-1020,
0x1.637d245b7c0dap-1020,
0x1.6481e1a5308acp-1020,
0x1.6429dfccc36b1p-1020,
0x1.652e9d1677e83p-1020,
0x1.65db5887bf45ap-1020,
0x1.668813f906a31p-1020,
0x1.64d69b3e0ac88p-1020,
0x1.64ac3e719da9ap-1020,
0x1.65b0fbbb5226cp-1020,
0x1.6558f9e2e5071p-1020,
0x1.665db72c99843p-1020,
0x1.6605b5542c648p-1020,
0x1.66e015d173c2cp-1020,
0x1.670a729de0e1ap-1020,
0x1.67b72e0f283f1p-1020,
0x1.6863e9806f9c8p-1020,
0x1.6910a4f1b6f9fp-1020,
0x1.678cd142bb203p-1020,
0x1.6734cf6a4e008p-1020,
0x1.68398cb4027dap-1020,
0x1.67e18adb955dfp-1020,
0x1.68e6482549db1p-1020,
0x1.68bbeb58dcbc3p-1020,
0x1.6993039691388p-1020,
0x1.6a3fbf07d895fp-1020,
0x1.6968a6ca2419ap-1020,
0x1.6aec7a791ff36p-1020,
0x1.6a15623b6b771p-1020,
0x1.69eb056efe583p-1020,
0x1.6ac21dacb2d48p-1020,
0x1.6c739667aeaf1p-1020,
0x1.6a97c0e045b5ap-1020,
0x1.6b6ed91dfa31fp-1020,
0x1.6bc6daf66751ap-1020,
0x1.6b447c518d131p-1020,
0x1.6c1b948f418f6p-1020,
0x1.6bf137c2d4708p-1020,
0x1.6cf5f50c88edap-1020,
0x1.6c9df3341bcdfp-1020,
0x1.6da2b07dd04b1p-1020,
0x1.6d4aaea5632b6p-1020,
0x1.6d2051d8f60c8p-1020,
0x1.6efc27605f05fp-1020,
0x1.6e4f6bef17a88p-1020,
0x1.6dcd0d4a3d69fp-1020,
0x1.6df76a16aa88dp-1020,
0x1.6ed1ca93f1e71p-1020,
0x1.6f7e860539448p-1020,
0x1.6e79c8bb84c76p-1020,
0x1.6f26842ccc24dp-1020,
0x1.6fa8e2d1a6636p-1020,
0x1.7000e4aa13831p-1020,
0x1.702b417680a1fp-1020,
0x1.7184b8590f5cdp-1020,
0x1.70d7fce7c7ff6p-1020,
0x1.70ada01b5ae08p-1020,
0x1.70559e42edc0dp-1020,
0x1.715a5b8ca23dfp-1020,
0x1.710259b4351e4p-1020,
0x1.720716fde99b6p-1020,
0x1.71dcba317c7c8p-1020,
0x1.723173ca56ba4p-1020,
0x1.72b3d26f30f8dp-1020,
0x1.740d4951bfb3bp-1020,
0x1.73608de078564p-1020,
0x1.728975a2c3d9fp-1020,
0x1.733631140b376p-1020,
0x1.730bd4479e188p-1020,
0x1.73e2ec855294dp-1020,
0x1.73b88fb8e575fp-1020,
0x1.748fa7f699f24p-1020,
0x1.74654b2a2cd36p-1020,
0x1.753c6367e14fbp-1020,
0x1.7512069b7430dp-1020,
0x1.76c37f56700b6p-1020,
0x1.74e7a9cf0711fp-1020,
0x1.75bec20cbb8e4p-1020,
0x1.759465404e6f6p-1020,
0x1.766b7d7e02ebbp-1020,
0x1.764120b195ccdp-1020,
0x1.771838ef4a492p-1020,
0x1.76eddc22dd2a4p-1020,
0x1.77f2996c91a76p-1020,
0x1.789f54ddd904dp-1020,
0x1.779a97942487bp-1020,
0x1.77703ac7b768dp-1020,
0x1.784753056be52p-1020,
0x1.781cf638fec64p-1020,
0x1.794c104f20624p-1020,
0x1.78c9b1aa4623bp-1020,
0x1.79ce6ef3faa0dp-1020,
0x1.7a7b2a6541fe4p-1020,
0x1.79766d1b8d812p-1020,
0x1.7a23288cd4de9p-1020,
0x1.7b27e5d6895bbp-1020,
0x1.79f8cbc067bfbp-1020,
0x1.7afd890a1c3cdp-1020,
0x1.7c815cb918169p-1020,
0x1.7aa58731af1d2p-1020,
0x1.7bd4a147d0b92p-1020,
0x1.7b5242a2f67a9p-1020,
0x1.7baa447b639a4p-1020,
0x1.7c56ffecaaf7bp-1020,
0x1.7d03bb5df2552p-1020,
0x1.7cd95e9185364p-1020,
0x1.7db076cf39b29p-1020,
0x1.7d2e182a5f74p-1020,
0x1.7d861a02cc93bp-1020,
0x1.7e5d3240811p-1020,
0x1.7e32d57413f12p-1020,
0x1.7e0878a7a6d24p-1020,
0x1.7edf90e55b4e9p-1020,
0x1.7f8c4c56a2acp-1020,
0x1.7eb53418ee2fbp-1020,
0x1.7f61ef8a358d2p-1020,
0x1.803907c7ea097p-1020,
0x1.7fe44e2f0fcbbp-1020,
0x1.81c023b678c52p-1020,
0x1.811368453167bp-1020,
0x1.800eaafb7cea9p-1020,
0x1.80bb666cc448p-1020,
0x1.809109a057292p-1020,
0x1.816821de0ba57p-1020,
0x1.813dc5119e869p-1020,
0x1.81ea8082e5e4p-1020,
0x1.82ef3dcc9a612p-1020,
0x1.839bf93de1be9p-1020,
0x1.826cdf27c0229p-1020,
0x1.82973bf42d417p-1020,
0x1.8448b4af291cp-1020,
0x1.8343f765749eep-1020,
0x1.83199a99078p-1020,
0x1.841e57e2bbfd2p-1020,
0x1.83c6560a4edd7p-1020,
0x1.8473117b963aep-1020,
0x1.84cb1354035a9p-1020,
0x1.8577cec54ab8p-1020,
0x1.86248a3692157p-1020,
0x1.86d145a7d972ep-1020,
0x1.84f5702070797p-1020,
0x1.85fa2d6a24f69p-1020,
0x1.85a22b91b7d6ep-1020,
0x1.864ee702ff345p-1020,
0x1.86a6e8db6c54p-1020,
0x1.8753a44cb3b17p-1020,
0x1.88005fbdfb0eep-1020,
0x1.8729478046929p-1020,
0x1.88ad1b2f426c5p-1020,
0x1.87d602f18dfp-1020,
0x1.877e011920d05p-1020,
0x1.8882be62d54d7p-1020,
0x1.8959d6a089c9cp-1020,
0x1.892f79d41caaep-1020,
0x1.89051d07af8cp-1020,
0x1.89dc354564085p-1020,
0x1.8a88f0b6ab65cp-1020,
0x1.89b1d878f6e97p-1020,
0x1.8a5e93ea3e46ep-1020,
0x1.8a34371dd128p-1020,
0x1.8b0b4f5b85a45p-1020,
0x1.8ae0f28f18857p-1020,
0x1.8cbcc816817eep-1020,
0x1.8c100ca53a217p-1020,
0x1.8bb80acccd01cp-1020,
0x1.8b8dae005fe2ep-1020,
0x1.8c64c63e145f3p-1020,
0x1.8c3a6971a7405p-1020,
0x1.8d3f26bb5bbd7p-1020,
0x1.8ce724e2ee9dcp-1020,
0x1.8d698387c8dc5p-1020,
0x1.8f45590f31d5cp-1020,
0x1.8d93e05435fb3p-1020,
0x1.8debe22ca31aep-1020,
0x1.8e989d9dea785p-1020,
0x1.8e163ef91039cp-1020,
0x1.8f1afc42c4b6ep-1020,
0x1.8ec2fa6a57973p-1020,
0x1.8f6fb5db9ef4ap-1020,
0x1.8fc7b7b40c145p-1020,
0x1.8ff2148079333p-1020,
0x1.907473255371cp-1020,
0x1.91212e969acf3p-1020,
0x1.91cdea07e22cap-1020,
0x1.904a1658e652ep-1020,
0x1.90f6d1ca2db05p-1020,
0x1.909ecff1c090ap-1020,
0x1.91a38d3b750dcp-1020,
0x1.937f62c2de073p-1020,
0x1.92fd041e03c8ap-1020,
0x1.927aa579298a1p-1020,
0x1.93d41c5bb844fp-1020,
0x1.9225ebe04f4c5p-1020,
0x1.932aa92a03c97p-1020,
0x1.92a84a85298aep-1020,
0x1.9484200c92845p-1020,
0x1.9401c167b845cp-1020,
0x1.95067eb16cc2ep-1020,
0x1.94d8d9a56cc21p-1020,
0x1.955b384a4700ap-1020,
0x1.94567b0092838p-1020,
0x1.965ff593fb7dcp-1020,
0x1.96e25438d5bc5p-1020,
0x1.95dd96ef213f3p-1020,
0x1.96325087fb7cfp-1020,
0x1.96b4af2cd5bb8p-1020,
0x1.95aff1e3213e6p-1020,
0x1.97370dd1affa1p-1020,
0x1.989084b43eb4fp-1020,
0x1.980e260f64766p-1020,
0x1.978bc76a8a37dp-1020,
0x1.9764b2ddaffaep-1020,
0x1.97b96c768a38ap-1020,
0x1.983bcb1b64773p-1020,
0x1.98be29c03eb5cp-1020,
0x1.9a99ff47a7af3p-1020,
0x1.9a17a0a2cd70ap-1020,
0x1.9912e35918f38p-1020,
0x1.999541fdf3321p-1020,
0x1.99e9fb96cd6fdp-1020,
0x1.9a6c5a3ba7ae6p-1020,
0x1.9940886518f45p-1020,
0x1.9b1c5dec81edcp-1020,
0x1.9aeeb8e081ecfp-1020,
0x1.9b7117855c2b8p-1020,
0x1.9bf3762a366a1p-1020,
0x1.9bc5d11e36694p-1020,
0x1.9c482fc310a7dp-1020,
0x1.9c75d4cf10a8ap-1020,
0x1.9d7a9218c525cp-1020,
0x1.9cf83373eae73p-1020,
0x1.9cca8e67eae66p-1020,
0x1.9dcf4bb19f638p-1020,
0x1.9d4ced0cc524fp-1020,
0x1.9da1a6a59f62bp-1020,
0x1.9e24054a79a14p-1020,
0x1.9e51aa5679a21p-1020,
0x1.9f5667a02e1f3p-1020,
0x1.9ed408fb53e0ap-1020,
0x1.9ea663ef53dfdp-1020,
0x1.9f28c2942e1e6p-1020,
0x1.9fab2139085cfp-1020,
0x1.9fffdad1e29abp-1020,
0x1.a104981b9717dp-1020,
0x1.a0823976bcd94p-1020,
0x1.a186f6c071566p-1020,
0x1.a02d7fdde29b8p-1020,
0x1.a0afde82bcda1p-1020,
0x1.a1323d279718ap-1020,
0x1.a20955654b94fp-1020,
0x1.a28bb40a25d38p-1020,
0x1.a30e12af00121p-1020,
0x1.a1dbb0594b942p-1020,
0x1.a2e06da300114p-1020,
0x1.a25e0efe25d2bp-1020,
0x1.a3907153da50ap-1020,
0x1.a362cc47da4fdp-1020,
0x1.a3e52aecb48e6p-1020,
0x1.a46789918eccfp-1020,
0x1.a4e9e836690b8p-1020,
0x1.a439e4858ecc2p-1020,
0x1.a3b785e0b48d9p-1020,
0x1.a4bc432a690abp-1020,
0x1.a615ba0cf7c59p-1020,
0x1.a69818b1d2042p-1020,
0x1.a56c46db434a1p-1020,
0x1.a53ea1cf43494p-1020,
0x1.a5c100741d87dp-1020,
0x1.a6435f18f7c66p-1020,
0x1.a81f34a060bfdp-1020,
0x1.a71a7756ac42bp-1020,
0x1.a79cd5fb86814p-1020,
0x1.a7f18f9460bfp-1020,
0x1.a6c5bdbdd204fp-1020,
0x1.a7481c62ac438p-1020,
0x1.a9a6508eef7b8p-1020,
0x1.a923f1ea153cfp-1020,
0x1.a8a193453afe6p-1020,
0x1.a873ee393afd9p-1020,
0x1.a8f64cde153c2p-1020,
0x1.a978ab82ef7abp-1020,
0x1.a9fb0a27c9b94p-1020,
0x1.a9cd651bc9b87p-1020,
0x1.aa7d68cca3f7dp-1020,
0x1.aaffc7717e366p-1020,
0x1.ab8226165874fp-1020,
0x1.aa4fc3c0a3f7p-1020,
0x1.aad222657e359p-1020,
0x1.ab54810a58742p-1020,
0x1.abd6dfaf32b2bp-1020,
0x1.ac593e540cf14p-1020,
0x1.acdb9cf8e72fdp-1020,
0x1.ad5dfb9dc16e6p-1020,
0x1.ac2b99480cf07p-1020,
0x1.acadf7ece72fp-1020,
0x1.ad305691c16d9p-1020,
0x1.ae076ecf75e9ep-1020,
0x1.ae89cd7450287p-1020,
0x1.af0c2c192a67p-1020,
0x1.adb2b5369bac2p-1020,
0x1.ae3513db75eabp-1020,
0x1.aeb7728050294p-1020,
0x1.af39d1252a67dp-1020,
0x1.af8e8abe04a59p-1020,
0x1.b010e962dee42p-1020,
0x1.b0934807b922bp-1020,
0x1.afe34456dee35p-1020,
0x1.b065a2fbb921ep-1020,
0x1.b0e801a093607p-1020,
0x1.afbc2fca04a66p-1020,
0x1.b115a6ac93614p-1020,
0x1.b19805516d9fdp-1020,
0x1.b16a60456d9fp-1020,
0x1.b1ecbeea47dd9p-1020,
0x1.b26f1d8f221c2p-1020,
0x1.b2417883221b5p-1020,
0x1.b41d4e0a8b14cp-1020,
0x1.b2f17c33fc5abp-1020,
0x1.b373dad8d6994p-1020,
0x1.b2c3d727fc59ep-1020,
0x1.b34635ccd6987p-1020,
0x1.b3c89471b0d7p-1020,
0x1.b44af3168b159p-1020,
0x1.b49facaf65535p-1020,
0x1.b5220b543f91ep-1020,
0x1.b5a469f919d07p-1020,
0x1.b626c89df40fp-1020,
0x1.b5f92391f40e3p-1020,
0x1.b4cd51bb65542p-1020,
0x1.b54fb0603f92bp-1020,
0x1.b5d20f0519d14p-1020,
0x1.b7ade48c82cabp-1020,
0x1.b72b85e7a88c2p-1020,
0x1.b6a92742ce4d9p-1020,
0x1.b6fde0dba88b5p-1020,
0x1.b67b8236ce4ccp-1020,
0x1.b7803f8082c9ep-1020,
0x1.b8029e255d087p-1020,
0x1.b884fcca3747p-1020,
0x1.b9075b6f11859p-1020,
0x1.b989ba13ebc42p-1020,
0x1.b8d9b6631184cp-1020,
0x1.b85757be37463p-1020,
0x1.b95c1507ebc35p-1020,
0x1.b9de73acc601ep-1020,
0x1.ba60d251a0407p-1020,
0x1.bae330f67a7fp-1020,
0x1.ba332d45a03fap-1020,
0x1.bab58bea7a7e3p-1020,
0x1.bb37ea8f54bccp-1020,
0x1.bc0f02cd09391p-1020,
0x1.bc916171e377ap-1020,
0x1.bb658f9b54bd9p-1020,
0x1.bbe7ee402efc2p-1020,
0x1.bbba49342efb5p-1020,
0x1.bc3ca7d90939ep-1020,
0x1.bcbf067de3787p-1020,
0x1.bd13c016bdb63p-1020,
0x1.be187d6072335p-1020,
0x1.bd961ebb97f4cp-1020,
0x1.be9adc054c71ep-1020,
0x1.bd416522bdb7p-1020,
0x1.be6d36f94c711p-1020,
0x1.bdc3c3c797f59p-1020,
0x1.bf1d3aaa26b07p-1020,
0x1.bf9f994f00efp-1020,
0x1.beef959e26afap-1020,
0x1.bf71f44300ee3p-1020,
0x1.bff452e7db2ccp-1020,
0x1.c0490c80b56a8p-1020,
0x1.c076b18cb56b5p-1020,
0x1.c224e2081e63fp-1020,
0x1.c0f910318fa9ep-1020,
0x1.c17b6ed669e87p-1020,
0x1.c0cb6b258fa91p-1020,
0x1.c1fdcd7b4427p-1020,
0x1.c14dc9ca69e7ap-1020,
0x1.c1d0286f44263p-1020,
0x1.c2a740acf8a28p-1020,
0x1.c3299f51d2e11p-1020,
0x1.c3abfdf6ad1fap-1020,
0x1.c25287141e64cp-1020,
0x1.c2d4e5b8f8a35p-1020,
0x1.c357445dd2e1ep-1020,
0x1.c3d9a302ad207p-1020,
0x1.c53319e53bdb5p-1020,
0x1.c4b0bb40619ccp-1020,
0x1.c42e5c9b875e3p-1020,
0x1.c4831634619bfp-1020,
0x1.c50574d93bda8p-1020,
0x1.c587d37e16191p-1020,
0x1.c5b5788a1619ep-1020,
0x1.c60a3222f057ap-1020,
0x1.c68c90c7ca963p-1020,
0x1.c70eef6ca4d4cp-1020,
0x1.c65eebbbca956p-1020,
0x1.c6e14a60a4d3fp-1020,
0x1.c7914e117f135p-1020,
0x1.c813acb65951ep-1020,
0x1.c763a9057f128p-1020,
0x1.c7e607aa59511p-1020,
0x1.c868664f338fap-1020,
0x1.c8eac4f40dce3p-1020,
0x1.c83ac143338edp-1020,
0x1.c8bd1fe80dcd6p-1020,
0x1.c96d2398e80ccp-1020,
0x1.ca98f56f76c6dp-1020,
0x1.c9ef823dc24b5p-1020,
0x1.c93f7e8ce80bfp-1020,
0x1.c9c1dd31c24a8p-1020,
0x1.ca443bd69c891p-1020,
0x1.cb1b541451056p-1020,
0x1.cb9db2b92b43fp-1020,
0x1.cc20115e05828p-1020,
0x1.cac69a7b76c7ap-1020,
0x1.cb48f92051063p-1020,
0x1.cbcb57c52b44cp-1020,
0x1.cc74caf6dfc04p-1020,
0x1.cca27002dfc11p-1020,
0x1.cd24cea7b9ffap-1020,
0x1.cda72d4c943e3p-1020,
0x1.ce298bf16e7ccp-1020,
0x1.ccf7299bb9fedp-1020,
0x1.cd798840943d6p-1020,
0x1.cdfbe6e56e7bfp-1020,
0x1.ce7e458a48ba8p-1020,
0x1.cf00a42f22f91p-1020,
0x1.ce50a07e48b9bp-1020,
0x1.cf8302d3fd37ap-1020,
0x1.ced2ff2322f84p-1020,
0x1.cf555dc7fd36dp-1020,
0x1.cfd7bc6cd7756p-1020,
0x1.d0aed4aa8bf1bp-1020,
0x1.d131334f66304p-1020,
0x1.d0056178d7763p-1020,
0x1.d05a1b11b1b3fp-1020,
0x1.d0dc79b68bf28p-1020,
0x1.d15ed85b66311p-1020,
0x1.d1b391f4406edp-1020,
0x1.d235f0991aad6p-1020,
0x1.d2b84f3df4ebfp-1020,
0x1.d33aade2cf2a8p-1020,
0x1.d28aaa31f4eb2p-1020,
0x1.d30d08d6cf29bp-1020,
0x1.d1e13700406fap-1020,
0x1.d3bd0c87a9691p-1020,
0x1.d38f677ba9684p-1020,
0x1.d411c62083a6dp-1020,
0x1.d49424c55de56p-1020,
0x1.d4667fb95de49p-1020,
0x1.d43f6b2c83a7ap-1020,
0x1.d4e8de5e38232p-1020,
0x1.d516836a3823fp-1020,
0x1.d598e20f12628p-1020,
0x1.d61b40b3eca11p-1020,
0x1.d56b3d031261bp-1020,
0x1.d5ed9ba7eca04p-1020,
0x1.d66ffa4cc6dedp-1020,
0x1.d6c4b3e5a11c9p-1020,
0x1.d6f258f1a11d6p-1020,
0x1.d774b7967b5bfp-1020,
0x1.d7f7163b559a8p-1020,
0x1.d747128a7b5b2p-1020,
0x1.d7c9712f5599bp-1020,
0x1.d84bcfd42fd84p-1020,
0x1.d8a0896d0a16p-1020,
0x1.d922e811e4549p-1020,
0x1.d9a546b6be932p-1020,
0x1.da27a55b98d1bp-1020,
0x1.d8ce2e790a16dp-1020,
0x1.d9508d1de4556p-1020,
0x1.d9d2ebc2be93fp-1020,
0x1.daaa040073104p-1020,
0x1.db2c62a54d4edp-1020,
0x1.dbaec14a278d6p-1020,
0x1.da7c5ef4730f7p-1020,
0x1.dafebd994d4ep-1020,
0x1.da554a6798d28p-1020,
0x1.db811c3e278c9p-1020,
0x1.dc311fef01cbfp-1020,
0x1.dc037ae301cb2p-1020,
0x1.dc85d987dc09bp-1020,
0x1.dd08382cb6484p-1020,
0x1.dcda9320b6477p-1020,
0x1.dd8a96d19086dp-1020,
0x1.dd5cf1c59086p-1020,
0x1.deb668a81f40ep-1020,
0x1.df38c74cf97f7p-1020,
0x1.de0cf5766ac56p-1020,
0x1.dddf506a6ac49p-1020,
0x1.de61af0f45032p-1020,
0x1.dee40db41f41bp-1020,
0x1.dfbb25f1d3bep-1020,
0x1.e03d8496adfc9p-1020,
0x1.e0bfe33b883b2p-1020,
0x1.df666c58f9804p-1020,
0x1.e0923e2f883a5p-1020,
0x1.dfe8cafdd3bedp-1020,
0x1.e06b29a2adfd6p-1020,
0x1.e1c4a0853cb84p-1020,
0x1.e14241e06279bp-1020,
0x1.e1149cd46278ep-1020,
0x1.e196fb793cb77p-1020,
0x1.e2195a1e16f6p-1020,
0x1.e29bb8c2f1349p-1020,
0x1.e246ff2a16f6dp-1020,
0x1.e31e1767cb732p-1020,
0x1.e3a0760ca5b1bp-1020,
0x1.e2f0725bcb725p-1020,
0x1.e422d4b17ff04p-1020,
0x1.e372d100a5b0ep-1020,
0x1.e3f52fa57fef7p-1020,
0x1.e4778e4a5a2ep-1020,
0x1.e4f9ecef346c9p-1020,
0x1.e57c4b940eab2p-1020,
0x1.e4cc47e3346bcp-1020,
0x1.e5feaa38e8e9bp-1020,
0x1.e54ea6880eaa5p-1020,
0x1.e5d1052ce8e8ep-1020,
0x1.e6a81d6a9d653p-1020,
0x1.e72a7c0f77a3cp-1020,
0x1.e7acdab451e25p-1020,
0x1.e68108ddc3284p-1020,
0x1.e65363d1c3277p-1020,
0x1.e6d5c2769d66p-1020,
0x1.e758211b77a49p-1020,
0x1.e7da7fc051e32p-1020,
0x1.e82f39592c20ep-1020,
0x1.e8b197fe065f7p-1020,
0x1.e933f6a2e09ep-1020,
0x1.e9065196e09d3p-1020,
0x1.e85cde652c21bp-1020,
0x1.e988b03bbadbcp-1020,
0x1.e9b65547badc9p-1020,
0x1.ea38b3ec951b2p-1020,
0x1.ea0b0ee0951a5p-1020,
0x1.ea8d6d856f58ep-1020,
0x1.eb0fcc2a49977p-1020,
0x1.eae2271e4996ap-1020,
0x1.ecbdfca5b2901p-1020,
0x1.eb922acf23d6p-1020,
0x1.eb6485c323d53p-1020,
0x1.ec148973fe149p-1020,
0x1.ec96e818d8532p-1020,
0x1.ebe6e467fe13cp-1020,
0x1.ec69430cd8525p-1020,
0x1.eceba1b1b290ep-1020,
0x1.ed405b4a8cceap-1020,
0x1.edc2b9ef670d3p-1020,
0x1.ee451894414bcp-1020,
0x1.eec777391b8a5p-1020,
0x1.ed6e00568ccf7p-1020,
0x1.edf05efb670ep-1020,
0x1.ee72bda0414c9p-1020,
0x1.ef49d5ddf5c8ep-1020,
0x1.efcc3482d0077p-1020,
0x1.ef1c30d1f5c81p-1020,
0x1.ef9e8f76d006ap-1020,
0x1.f020ee1baa453p-1020,
0x1.f04e9327aa46p-1020,
0x1.f0a34cc08483cp-1020,
0x1.f125ab655ec25p-1020,
0x1.f1a80a0a3900ep-1020,
0x1.f0f806595ec18p-1020,
0x1.f17a64fe39001p-1020,
0x1.f22a68af133f7p-1020,
0x1.f1fcc3a3133eap-1020,
0x1.f2acc753ed7ep-1020,
0x1.f27f2247ed7d3p-1020,
0x1.f30180ecc7bbcp-1020,
0x1.f383df91a1fa5p-1020,
0x1.f2d3dbe0c7bafp-1020,
0x1.f3563a85a1f98p-1020,
0x1.f3d8992a7c381p-1020,
0x1.f4063e367c38ep-1020,
0x1.f532100d0af2fp-1020,
0x1.f4889cdb56777p-1020,
0x1.f45af7cf5676ap-1020,
0x1.f4dd567430b53p-1020,
0x1.f55fb5190af3cp-1020,
0x1.f5b46eb1e5318p-1020,
0x1.f636cd56bf701p-1020,
0x1.f6b92bfb99aeap-1020,
0x1.f73b8aa073ed3p-1020,
0x1.f5e213bde5325p-1020,
0x1.f70de59473ec6p-1020,
0x1.f6647262bf70ep-1020,
0x1.f7bde9454e2bcp-1020,
0x1.f84047ea286a5p-1020,
0x1.f8c2a68f02a8ep-1020,
0x1.f79044394e2afp-1020,
0x1.f812a2de28698p-1020,
0x1.f895018302a81p-1020,
0x1.f8e9bb1bdce5dp-1020,
0x1.f9176027dce6ap-1020,
0x1.f999beccb7253p-1020,
0x1.fa1c1d719163cp-1020,
0x1.f96c19c0b7246p-1020,
0x1.f9ee78659162fp-1020,
0x1.fa9e7c166ba25p-1020,
0x1.fa70d70a6ba18p-1020,
0x1.fb47ef48201ddp-1020,
0x1.fbca4decfa5c6p-1020,
0x1.fc4cac91d49afp-1020,
0x1.faf335af45e01p-1020,
0x1.fb759454201eap-1020,
0x1.fbf7f2f8fa5d3p-1020,
0x1.fccf0b36aed98p-1020,
0x1.fdd3c8806356ap-1020,
0x1.fd5169db89181p-1020,
0x1.fc7a519dd49bcp-1020,
0x1.fd23c4cf89174p-1020,
0x1.fda623746355dp-1020,
0x1.fe2882193d946p-1020,
0x1.feaae0be17d2fp-1020,
0x1.ff2d3f62f2118p-1020,
0x1.fe5627253d953p-1020,
0x1.ffaf9e07cc501p-1020,
0x1.feff9a56f210bp-1020,
0x1.fed885ca17d3cp-1020,
0x1.ff81f8fbcc4f4p-1020,
};

/* check worst cases in [2^-1020, 2^-53) from those in the
   binade 2^-1020 <= x < 2^-1019 */
static void
check_tiny (void)
{
  for (int i = 0; i < N_WORST; i++)
  {
    double x = T[i];
    for (int e = -1019; e <= -53; e++)
    {
      // check binade 2^(e-1) <= |x| < 2^e
      check (ldexp (x, e + 1019));
      check (ldexp (-x, e + 1019));
    }
  }
}

int
main (int argc, char *argv[])
{
  while (argc >= 2)
    {
      if (strcmp (argv[1], "--rndn") == 0)
        {
          rnd = 0;
          argc --;
          argv ++;
        }
      else if (strcmp (argv[1], "--rndz") == 0)
        {
          rnd = 1;
          argc --;
          argv ++;
        }
      else if (strcmp (argv[1], "--rndu") == 0)
        {
          rnd = 2;
          argc --;
          argv ++;
        }
      else if (strcmp (argv[1], "--rndd") == 0)
        {
          rnd = 3;
          argc --;
          argv ++;
        }
      else if (strcmp (argv[1], "--verbose") == 0)
        {
          verbose = 1;
          argc --;
          argv ++;
        }
      else
        {
          fprintf (stderr, "Error, unknown option %s\n", argv[1]);
          exit (1);
        }
    }
  ref_init ();
  ref_fesetround (rnd);

  printf ("Checking tiny values\n");
  check_tiny ();

  printf ("Checking random values\n");
#define K 1000000000UL /* total number of tests */
#define BUF_SIZE 1000

  long seed = getpid ();
  srand48 (seed);
  
  double buf[BUF_SIZE];
  uint64_t N = K / BUF_SIZE;
  for (uint64_t n = 0; n < N; n++)
  {
    /* warning: drand48 is not thread-safe, thus we put it outside
       the parallel loop */
    for (int i = 0; i < BUF_SIZE; i++)
    {
      buf[i] = drand48 ();
      if (i & 1)
        buf[i] = -buf[i];
    }
#pragma omp parallel for
    for (int i = 0; i < BUF_SIZE; i++)
      check (buf[i]);
  }

  return 0;
}

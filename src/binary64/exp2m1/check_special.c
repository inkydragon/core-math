/* Check exp2m1 on random inputs.

Copyright (c) 2022-2023 Paul Zimmermann, Inria.

This file is part of the CORE-MATH project
(https://core-math.gitlabpages.inria.fr/).

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
*/

#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <string.h>
#include <fenv.h>
#include <math.h>
#include <sys/types.h>
#include <unistd.h>
#include <assert.h>

int ref_init (void);
int ref_fesetround (int);

double cr_exp2m1 (double);
double ref_exp2m1 (double);

int rnd1[] = { FE_TONEAREST, FE_TOWARDZERO, FE_UPWARD, FE_DOWNWARD };

int rnd = 0;
int verbose = 0;

static inline uint64_t
asuint64 (double f)
{
  union
  {
    double f;
    uint64_t i;
  } u = {f};
  return u.i;
}

typedef union {double f; uint64_t u;} b64u64_u;

static double
get_random ()
{
  b64u64_u v;
  long l;
  v.u = rand ();
  v.u |= (uint64_t) rand () << 31;
  v.u |= (uint64_t) rand () << 62;
  return v.f;
}

static void
check (double x)
{
  int bug;
  double y1 = ref_exp2m1 (x);
  fesetround (rnd1[rnd]);
  double y2 = cr_exp2m1 (x);
  if (isnan (y1))
    bug = !isnan (y2);
  else if (isnan (y2))
    bug = !isnan (y1);
  else
    bug = asuint64 (y1) != asuint64 (y2);
  if (bug)
  {
    printf ("FAIL x=%la ref=%la z=%la\n", x, y1, y2);
    fflush (stdout);
    exit (1);
  }
}

#define N_WORST 1027

/* worst cases in [2^-1022,2^-1021) extracted from exp2m1.wc */
static double T[N_WORST] = {
0x1.0194648f13ea5p-1022,
0x1.02638d37d157p-1022,
0x1.0332b5e08ec3bp-1022,
0x1.02833da056eb6p-1022,
0x1.0401de894c306p-1022,
0x1.00e4ec4edc12p-1022,
0x1.04d10732099d1p-1022,
0x1.066f588384767p-1022,
0x1.0352664914581p-1022,
0x1.04218ef1d1c4cp-1022,
0x1.01b414f7997ebp-1022,
0x1.082d5a3d84e43p-1022,
0x1.075e3194c7778p-1022,
0x1.037216b199ec7p-1022,
0x1.068f08ec0a0adp-1022,
0x1.03130578092f5p-1022,
0x1.05a02fdac709cp-1022,
0x1.04f0b79a8f317p-1022,
0x1.04413f5a57592p-1022,
0x1.06aeb9548f9f3p-1022,
0x1.077de1fd4d0bep-1022,
0x1.084d0aa60a789p-1022,
0x1.0510680314c5dp-1022,
0x1.06ce69bd15339p-1022,
0x1.0174b4268e55fp-1022,
0x1.086cbb0e900cfp-1022,
0x1.079d9265d2a04p-1022,
0x1.05bfe0434c9e2p-1022,
0x1.05df90abd2328p-1022,
0x1.0243dccf4bc2ap-1022,
0x1.0c9836c2c8c0cp-1022,
0x1.0085db154b54ep-1022,
0x1.00a58b7dd0e94p-1022,
0x1.00c53be6567dap-1022,
0x1.0d675f6b862d7p-1022,
0x1.09eb5bf78551fp-1022,
0x1.0e368814439a2p-1022,
0x1.0a0b0c600ae65p-1022,
0x1.0a2abcc8907abp-1022,
0x1.0f05b0bd0106dp-1022,
0x1.0cb7e72b4e552p-1022,
0x1.0d870fd40bc1dp-1022,
0x1.0fd4d965be738p-1022,
0x1.0e56387cc92e8p-1022,
0x1.0f256125869b3p-1022,
0x1.0c58d5f1bd98p-1022,
0x1.0ff489ce4407ep-1022,
0x1.0aba84a042beap-1022,
0x1.0b89ad49002b5p-1022,
0x1.0c78865a432c6p-1022,
0x1.0ada3508c853p-1022,
0x1.10a4020e7be03p-1022,
0x1.0f45118e0c2f9p-1022,
0x1.10143a36c99c4p-1022,
0x1.0e16d7abbe05cp-1022,
0x1.0ba95db185bfbp-1022,
0x1.0d47af0300991p-1022,
0x1.0af9e5714de76p-1022,
0x1.0ee600547b727p-1022,
0x1.10c3b27701749p-1022,
0x1.0bc90e1a0b541p-1022,
0x1.10e362df8708fp-1022,
0x1.08fc82e64250ep-1022,
0x1.1242535ff6b99p-1022,
0x1.091c334ec7e54p-1022,
0x1.093be3b74d79ap-1022,
0x1.126203c87c4dfp-1022,
0x1.095b941fd30ep-1022,
0x1.1281b43101e25p-1022,
0x1.186b319f3b03ep-1022,
0x1.12a164998776bp-1022,
0x1.13312c7139baap-1022,
0x1.188ae207c0984p-1022,
0x1.14cf7dc2b494p-1022,
0x1.14005519f7275p-1022,
0x1.1350dcd9bf4fp-1022,
0x1.193a5a47f8709p-1022,
0x1.14ef2e2b3a286p-1022,
0x1.13708d4244e36p-1022,
0x1.142005827cbbbp-1022,
0x1.150ede93bfbccp-1022,
0x1.182bd0ce2fdb2p-1022,
0x1.175ca825726e7p-1022,
0x1.168d7f7cb501cp-1022,
0x1.152e8efc45512p-1022,
0x1.177c588df802dp-1022,
0x1.15be56d3f7951p-1022,
0x1.143fb5eb02501p-1022,
0x1.16ad2fe53a962p-1022,
0x1.184b8136b56f8p-1022,
0x1.179c08f67d973p-1022,
0x1.195a0ab07e04fp-1022,
0x1.1a0982f0b5dd4p-1022,
0x1.15de073c7d297p-1022,
0x1.191aa9df72dc3p-1022,
0x1.16cce04dc02a8p-1022,
0x1.15fdb7a502bddp-1022,
0x1.1a2933593b71ap-1022,
0x1.1ad8ab997349fp-1022,
0x1.19e9d2883048ep-1022,
0x1.1af85c01f8de5p-1022,
0x1.1b180c6a7e72bp-1022,
0x1.11732ab7394cep-1022,
0x1.1b8823d9ab224p-1022,
0x1.1192db1fbee14p-1022,
0x1.1ba7d44230b6ap-1022,
0x1.11b28b884475ap-1022,
0x1.1bc784aab64bp-1022,
0x1.1c76fceaee235p-1022,
0x1.1e154e3c68fcbp-1022,
0x1.1d462593ab9p-1022,
0x1.1be735133bdf6p-1022,
0x1.1c96ad5373b7bp-1022,
0x1.1e34fea4ee911p-1022,
0x1.1d65d5fc31246p-1022,
0x1.1f04274dabfdcp-1022,
0x1.1cb65dbbf94c1p-1022,
0x1.1e54af0d74257p-1022,
0x1.1e745f75f9b9dp-1022,
0x1.1f23d7b631922p-1022,
0x1.1d858664b6b8cp-1022,
0x1.1fd34ff6696a7p-1022,
0x1.20a2789f26d72p-1022,
0x1.1f43881eb7268p-1022,
0x1.20c22907ac6b8p-1022,
0x1.1ff3005eeefedp-1022,
0x1.2171a147e443dp-1022,
0x1.20e1d97031ffep-1022,
0x1.219151b069d83p-1022,
0x1.2012b0c774933p-1022,
0x1.210189d8b7944p-1022,
0x1.21b10218ef6c9p-1022,
0x1.21d0b2817500fp-1022,
0x1.236f03d2efda5p-1022,
0x1.232fa301e4b19p-1022,
0x1.275b1eb61d656p-1022,
0x1.22607a592744ep-1022,
0x1.234f536a6a45fp-1022,
0x1.22802ac1acd94p-1022,
0x1.243e2c7bad47p-1022,
0x1.229fdb2a326dap-1022,
0x1.250d55246ab3bp-1022,
0x1.25dc7dcd28206p-1022,
0x1.26aba675e58d1p-1022,
0x1.245ddce432db6p-1022,
0x1.252d058cf0481p-1022,
0x1.277acf1ea2f9cp-1022,
0x1.25fc2e35adb4cp-1022,
0x1.26cb56de6b217p-1022,
0x1.279a7f87288e2p-1022,
0x1.2849f7c760667p-1022,
0x1.26eb0746f0b5dp-1022,
0x1.1ab8fb30edb59p-1022,
0x1.24eda4bbe51f5p-1022,
0x1.27ba2fefae228p-1022,
0x1.2869a82fe5fadp-1022,
0x1.25bccd64a28cp-1022,
0x1.29e84918db3fdp-1022,
0x1.288958986b8f3p-1022,
0x1.291920701dd32p-1022,
0x1.2a07f98160d43p-1022,
0x1.268bf60d5ff8bp-1022,
0x1.2a27a9e9e6689p-1022,
0x1.2938d0d8a3678p-1022,
0x1.2ad7222a1e40ep-1022,
0x1.2a475a526bfcfp-1022,
0x1.2958814128fbep-1022,
0x1.2af6d292a3d54p-1022,
0x1.2b1682fb2969ap-1022,
0x1.325ef0e9d23bdp-1022,
0x1.2e72d606a4b0cp-1022,
0x1.2ba64ad2dbad9p-1022,
0x1.2f41feaf621d7p-1022,
0x1.2bc5fb3b6141fp-1022,
0x1.301127581f8a2p-1022,
0x1.2c75737b991a4p-1022,
0x1.2be5aba3e6d65p-1022,
0x1.30e05000dcf6dp-1022,
0x1.332e19928fa88p-1022,
0x1.2c9523e41eaeap-1022,
0x1.31af78a99a638p-1022,
0x1.327ea15257d03p-1022,
0x1.3030d7c0a51e8p-1022,
0x1.2d449c245686fp-1022,
0x1.2cb4d44ca443p-1022,
0x1.2e3375359988p-1022,
0x1.2d644c8cdc1b5p-1022,
0x1.329e51badd649p-1022,
0x1.31000069628b3p-1022,
0x1.2cd484b529d76p-1022,
0x1.32be022362f8fp-1022,
0x1.2e53259e1f1c6p-1022,
0x1.31cf29121ff7ep-1022,
0x1.2d83fcf561afbp-1022,
0x1.2f029dde56f4bp-1022,
0x1.2fd1c68714616p-1022,
0x1.2da3ad5de7441p-1022,
0x1.2f224e46dc891p-1022,
0x1.2ff176ef99f5cp-1022,
0x1.334dc9fb153cep-1022,
0x1.30c09f9857627p-1022,
0x1.318fc84114cf2p-1022,
0x1.336d7a639ad14p-1022,
0x1.23fecbaaa21e4p-1022,
0x1.338d2acc2065ap-1022,
0x1.241e7c1327b2ap-1022,
0x1.3976a83a59873p-1022,
0x1.3a45d0e316f3ep-1022,
0x1.35bb43f54d82fp-1022,
0x1.341cf2a3d2a99p-1022,
0x1.35daf45dd3175p-1022,
0x1.38486e580b5d6p-1022,
0x1.38681ec090f1cp-1022,
0x1.36aa1d069084p-1022,
0x1.35faa4c658abbp-1022,
0x1.3b14f98bd4609p-1022,
0x1.3887cf2916862p-1022,
0x1.36c9cd6f16186p-1022,
0x1.3be4223491cd4p-1022,
0x1.377945af4df0bp-1022,
0x1.361a552ede401p-1022,
0x1.38a77f919c1a8p-1022,
0x1.343ca30c583dfp-1022,
0x1.39179700c8ca1p-1022,
0x1.3798f617d3851p-1022,
0x1.36e97dd79baccp-1022,
0x1.345c5374ddd25p-1022,
0x1.393747694e5e7p-1022,
0x1.3a0670120bcb2p-1022,
0x1.37b8a68059197p-1022,
0x1.3c03d29d1761ap-1022,
0x1.3ad598bac937dp-1022,
0x1.3a26207a915f8p-1022,
0x1.3956f7d1d3f2dp-1022,
0x1.3cb34add4f39fp-1022,
0x1.3af549234ecc3p-1022,
0x1.3ba4c16386a48p-1022,
0x1.3c939a74c9a59p-1022,
0x1.3cd2fb45d4ce5p-1022,
0x1.3bc471cc0c38ep-1022,
0x1.3e31ebc6447efp-1022,
0x1.3d8273860ca6ap-1022,
0x1.3da223ee923bp-1022,
0x1.3f01146f01ebap-1022,
0x1.3d62c31d87124p-1022,
0x1.447a7a6e0e5dap-1022,
0x1.3e519c2eca135p-1022,
0x1.3f20c4d7878p-1022,
0x1.3e714c974fa7bp-1022,
0x1.3e90fcffd53c1p-1022,
0x1.3f4075400d146p-1022,
0x1.3fefed8044ecbp-1022,
0x1.3f6025a892a8cp-1022,
0x1.40bf162902596p-1022,
0x1.400f9de8ca811p-1022,
0x1.40dec69187edcp-1022,
0x1.427d17e302c72p-1022,
0x1.418e3ed1bfc61p-1022,
0x1.402f4e5150157p-1022,
0x1.429cc84b885b8p-1022,
0x1.42bc78b40defep-1022,
0x1.40fe76fa0d822p-1022,
0x1.41adef3a455a7p-1022,
0x1.4549a316cbca5p-1022,
0x1.434c408bc033dp-1022,
0x1.436bf0f445c83p-1022,
0x1.41cd9fa2caeedp-1022,
0x1.34ec1b4c90164p-1022,
0x1.41ed500b50833p-1022,
0x1.44ea91dd3b0d3p-1022,
0x1.438ba15ccb5c9p-1022,
0x1.350bcbb515aaap-1022,
0x1.4618cbbf8937p-1022,
0x1.450a4245c0a19p-1022,
0x1.352b7c1d9b3fp-1022,
0x1.4529f2ae4635fp-1022,
0x1.45d96aee7e0e4p-1022,
0x1.45f91b5703a2ap-1022,
0x1.4935bdf9f9556p-1022,
0x1.46e7f46846a3bp-1022,
0x1.46a893973b7afp-1022,
0x1.46c843ffc10f5p-1022,
0x1.47b71d1104106p-1022,
0x1.4a04e6a2b6c21p-1022,
0x1.488645b9c17d1p-1022,
0x1.47d6cd7989a4cp-1022,
0x1.4ad40f4b742ecp-1022,
0x1.4777bc3ff8e7ap-1022,
0x1.49556e627ee9cp-1022,
0x1.48a5f62247117p-1022,
0x1.47976ca87e7cp-1022,
0x1.4a24970b3c567p-1022,
0x1.49751ecb047e2p-1022,
0x1.4af3bfb3f9c32p-1022,
0x1.486695513be8bp-1022,
0x1.4a444773c1eadp-1022,
0x1.4b13701c7f578p-1022,
0x1.4a63f7dc477f3p-1022,
0x1.4b33208504ebep-1022,
0x1.4c921105749c8p-1022,
0x1.4bc2e85cb72fdp-1022,
0x1.4cb1c16dfa30ep-1022,
0x1.4cd171d67fc54p-1022,
0x1.4be298c53cc43p-1022,
0x1.4e5012bf750a4p-1022,
0x1.4f1f3b683276fp-1022,
0x1.4f3eebd0b80b5p-1022,
0x1.4e6fc327fa9eap-1022,
0x1.4c02492dc2589p-1022,
0x1.4f5e9c393d9fbp-1022,
0x1.4e8f73908033p-1022,
0x1.441b69347da08p-1022,
0x1.443b199d0334ep-1022,
0x1.445aca0588c94p-1022,
0x1.504d754a80a0cp-1022,
0x1.5439902dae2bdp-1022,
0x1.4fee6410efe3ap-1022,
0x1.511c9df33e0d7p-1022,
0x1.51ebc69bfb7a2p-1022,
0x1.52baef44b8e6dp-1022,
0x1.500e14797578p-1022,
0x1.538a17ed76538p-1022,
0x1.502dc4e1fb0c6p-1022,
0x1.53a9c855fbe7ep-1022,
0x1.5508b8d66b988p-1022,
0x1.5459409633c03p-1022,
0x1.55d7e17f29053p-1022,
0x1.534ab71c6b2acp-1022,
0x1.5478f0feb9549p-1022,
0x1.527b8e73adbe1p-1022,
0x1.50bd8cb9ad505p-1022,
0x1.529b3edc33527p-1022,
0x1.536a6784f0bf2p-1022,
0x1.50dd3d2232e4bp-1022,
0x1.5528693ef12cep-1022,
0x1.56a70a27e671ep-1022,
0x1.51ac65caf0516p-1022,
0x1.55f791e7ae999p-1022,
0x1.50fced8ab8791p-1022,
0x1.554819a776c14p-1022,
0x1.56174250342dfp-1022,
0x1.51cc163375e5cp-1022,
0x1.56c6ba906c064p-1022,
0x1.5636f2b8b9c25p-1022,
0x1.56e66af8f19aap-1022,
0x1.5795e3392972fp-1022,
0x1.57061b61772fp-1022,
0x1.57b593a1af075p-1022,
0x1.57d5440a349bbp-1022,
0x1.58650be1e6dfap-1022,
0x1.5884bc4a6c74p-1022,
0x1.58a46cb2f2086p-1022,
0x1.5934348aa44c5p-1022,
0x1.5f3d626163024p-1022,
0x1.5bc15eed6226cp-1022,
0x1.5c207026f2e3ep-1022,
0x1.5953e4f329e0bp-1022,
0x1.5cef98cfb0509p-1022,
0x1.5a230d9be74d6p-1022,
0x1.5be10f55e7bb2p-1022,
0x1.5973955baf751p-1022,
0x1.5af23644a4ba1p-1022,
0x1.5c00bfbe6d4f8p-1022,
0x1.5dbec1786dbd4p-1022,
0x1.599345c435097p-1022,
0x1.5b11e6ad2a4e7p-1022,
0x1.5a42be046ce1cp-1022,
0x1.5a626e6cf2762p-1022,
0x1.5e8dea212b29fp-1022,
0x1.5b319715afe2dp-1022,
0x1.600c8b0a206efp-1022,
0x1.5f5d12c9e896ap-1022,
0x1.5d7f60a762948p-1022,
0x1.5c9087961f937p-1022,
0x1.5cb037fea527dp-1022,
0x1.5d9f110fe828ep-1022,
0x1.5e4e895020013p-1022,
0x1.5f7cc3326e2bp-1022,
0x1.5f1db1f8dd6dep-1022,
0x1.5ccfe8672abc3p-1022,
0x1.5e6e39b8a5959p-1022,
0x1.602c3b72a6035p-1022,
0x1.60dbb3b2dddbap-1022,
0x1.61aadc5b9b485p-1022,
0x1.604bebdb2b97bp-1022,
0x1.60fb641b637p-1022,
0x1.61ca8cc420dcbp-1022,
0x1.627a050458b5p-1022,
0x1.61ea3d2ca6711p-1022,
0x1.611b1483e9046p-1022,
0x1.6209ed952c057p-1022,
0x1.6299b56cde496p-1022,
0x1.6368de159bb61p-1022,
0x1.62b965d563ddcp-1022,
0x1.62d9163de9722p-1022,
0x1.643806be5922cp-1022,
0x1.63888e7e214a7p-1022,
0x1.4d6139ae32093p-1022,
0x1.6457b726deb72p-1022,
0x1.63a83ee6a6dedp-1022,
0x1.4d80ea16b79d9p-1022,
0x1.6477678f644b8p-1022,
0x1.65072f67168f7p-1022,
0x1.67f36b036527p-1022,
0x1.4da09a7f3d31fp-1022,
0x1.6526dfcf9c23dp-1022,
0x1.4dc04ae7c2c65p-1022,
0x1.6546903821b83p-1022,
0x1.65f6087859908p-1022,
0x1.66c5312116fd3p-1022,
0x1.656640a0a74c9p-1022,
0x1.679459c9d469ep-1022,
0x1.67b40a3259fe4p-1022,
0x1.6615b8e0df24ep-1022,
0x1.67d3ba9adf92ap-1022,
0x1.66e4e1899c919p-1022,
0x1.6635694964b94p-1022,
0x1.670491f22225fp-1022,
0x1.68c293ac2293bp-1022,
0x1.6a41349517d8bp-1022,
0x1.6863827291d69p-1022,
0x1.688332db176afp-1022,
0x1.6991bc54e0006p-1022,
0x1.6b105d3dd5456p-1022,
0x1.68a2e3439cff5p-1022,
0x1.69525b83d4d7ap-1022,
0x1.69720bec5a6cp-1022,
0x1.6bdf85e692b21p-1022,
0x1.6a60e4fd9d6d1p-1022,
0x1.6b300da65ad9cp-1022,
0x1.6a21842c92445p-1022,
0x1.6b4fbe0ee06e2p-1022,
0x1.6bff364f18467p-1022,
0x1.6caeae8f501ecp-1022,
0x1.6c1ee6b79ddadp-1022,
0x1.6d7dd7380d8b7p-1022,
0x1.6af0acd54fb1p-1022,
0x1.6cce5ef7d5b32p-1022,
0x1.6e4cffe0caf82p-1022,
0x1.6cee0f605b478p-1022,
0x1.700b019acb65ep-1022,
0x1.6d9d87a0931fdp-1022,
0x1.702ab20350fa4p-1022,
0x1.6dbd380918b43p-1022,
0x1.6e6cb049508c8p-1022,
0x1.6f3bd8f20df93p-1022,
0x1.704a626bd68eap-1022,
0x1.6f5b895a938d9p-1022,
0x1.6e8c60b1d620ep-1022,
0x1.6f7b39c31921fp-1022,
0x1.6eac111a5bb54p-1022,
0x1.70da2a4388d29p-1022,
0x1.70f9daac0e66fp-1022,
0x1.71198b1493fb5p-1022,
0x1.71393b7d198fbp-1022,
0x1.7158ebe59f241p-1022,
0x1.74562db789ae1p-1022,
0x1.7a5f5b8e4864p-1022,
0x1.7b4e349f8b651p-1022,
0x1.736754a646adp-1022,
0x1.7a9ebc5f538ccp-1022,
0x1.72787b9503abfp-1022,
0x1.767340ab1ad8fp-1022,
0x1.7970827d0562fp-1022,
0x1.7acf72fd75139p-1022,
0x1.7189a283c0aaep-1022,
0x1.75846799d7d7ep-1022,
0x1.7881a96bc261ep-1022,
0x1.74958e8894d6dp-1022,
0x1.7b8d9570968ddp-1022,
0x1.7792d05a7f60dp-1022,
0x1.76a3f7493c5fcp-1022,
0x1.73a6b57751d5cp-1022,
0x1.7b0ed3ce803c5p-1022,
0x1.75b51e37f95ebp-1022,
0x1.78c10a3ccd8aap-1022,
0x1.79afe34e108bbp-1022,
0x1.71c90354cbd3ap-1022,
0x1.72b7dc660ed4bp-1022,
0x1.7bbe4c0eb814ap-1022,
0x1.75f47f0904877p-1022,
0x1.77d2312b8a899p-1022,
0x1.76e3581a47888p-1022,
0x1.72f73d3719fd7p-1022,
0x1.7bfdacdfc33d6p-1022,
0x1.73e616485cfe8p-1022,
0x1.7505a5f7c1866p-1022,
0x1.72086425d6fc6p-1022,
0x1.79006b0dd8b36p-1022,
0x1.7416cce67e855p-1022,
0x1.781191fc95b25p-1022,
0x1.7a1ffabd3d3b4p-1022,
0x1.7633dfda0fb03p-1022,
0x1.7722b8eb52b14p-1022,
0x1.7247c4f6e2252p-1022,
0x1.7327f3d53b844p-1022,
0x1.793121abfa3a3p-1022,
0x1.7842489ab7392p-1022,
0x1.754506c8ccaf2p-1022,
0x1.7c3d0db0ce662p-1022,
0x1.7f3a4f82b8f02p-1022,
0x1.7cad251ffb15bp-1022,
0x1.7cec85f1063e7p-1022,
0x1.7e4b767175ef1p-1022,
0x1.8632566abaa72p-1022,
0x1.7d2be6c211673p-1022,
0x1.7d5c9d6032eep-1022,
0x1.82463b878d1c1p-1022,
0x1.85437d5977a61p-1022,
0x1.815762764a1bp-1022,
0x1.806889650719fp-1022,
0x1.8454a44834a5p-1022,
0x1.7f79b053c418ep-1022,
0x1.8365cb36f1a3fp-1022,
0x1.7e8ad7428117dp-1022,
0x1.7d9bfe313e16cp-1022,
0x1.87212f7bfda83p-1022,
0x1.8276f225aea2ep-1022,
0x1.8671b73bc5cfep-1022,
0x1.7fb91124cf41ap-1022,
0x1.818819146ba1dp-1022,
0x1.8582de2a82cedp-1022,
0x1.849405193fcdcp-1022,
0x1.7ddb5f02493f8p-1022,
0x1.83a52c07fcccbp-1022,
0x1.80d8a0d433c98p-1022,
0x1.86a26dd9e756bp-1022,
0x1.7fe9c7c2f0c87p-1022,
0x1.81c779e576ca9p-1022,
0x1.7eca38138c409p-1022,
0x1.82b652f6b9cbap-1022,
0x1.7e1abfd354684p-1022,
0x1.84d365ea4af68p-1022,
0x1.811801a53ef24p-1022,
0x1.83e48cd907f57p-1022,
0x1.8206dab681f35p-1022,
0x1.7efaeeb1adc76p-1022,
0x1.86e1ceaaf27f7p-1022,
0x1.85041c886c7d5p-1022,
0x1.82f5b3c7c4f46p-1022,
0x1.85f2f599af7e6p-1022,
0x1.84154377297c4p-1022,
0x1.80292893fbf13p-1022,
0x1.8760904d08d0fp-1022,
0x1.879146eb2a57cp-1022,
0x1.87d0a7bc35808p-1022,
0x1.8a1e714de8323p-1022,
0x1.8810088d40a94p-1022,
0x1.8e193663ff5f3p-1022,
0x1.892f983ca5312p-1022,
0x1.91167835e9e93p-1022,
0x1.8d2a5d52bc5e2p-1022,
0x1.90279f24a6e82p-1022,
0x1.8c3b8441795d1p-1022,
0x1.8f38c61363e71p-1022,
0x1.88801ffc6d58dp-1022,
0x1.8b4cab30365cp-1022,
0x1.8a5dd21ef35afp-1022,
0x1.8e49ed0220e6p-1022,
0x1.896ef90db059ep-1022,
0x1.8d5b13f0dde4fp-1022,
0x1.88bf80cd78819p-1022,
0x1.8a9d32effe83bp-1022,
0x1.9066fff5b210ep-1022,
0x1.9155d906f511fp-1022,
0x1.8f7826e46f0fdp-1022,
0x1.8b8c0c014184cp-1022,
0x1.8d9a74c1e90dbp-1022,
0x1.8e894dd32c0ecp-1022,
0x1.8acde98e200a8p-1022,
0x1.89ae59debb82ap-1022,
0x1.8bbcc29f630b9p-1022,
0x1.88fee19e83aa5p-1022,
0x1.90a660c6bd39ap-1022,
0x1.8cab9bb0a60cap-1022,
0x1.8fb787b57a389p-1022,
0x1.8ec8aea437378p-1022,
0x1.8b0d4a5f2b334p-1022,
0x1.8dd9d592f4367p-1022,
0x1.91c5f07621c18p-1022,
0x1.8fe83e539bbf6p-1022,
0x1.8bfc23706e345p-1022,
0x1.90d71764dec07p-1022,
0x1.8ceafc81b1356p-1022,
0x1.89edbaafc6ab6p-1022,
0x1.920551472cea4p-1022,
0x1.93338b297b141p-1022,
0x1.936441c79c9aep-1022,
0x1.9502931917744p-1022,
0x1.93a3a298a7c3ap-1022,
0x1.93e30369b2ec6p-1022,
0x1.98fd582f2ea14p-1022,
0x1.9bfa9a01192b4p-1022,
0x1.971fa60ca89f2p-1022,
0x1.9630ccfb659e1p-1022,
0x1.9541f3ea229dp-1022,
0x1.94531ad8df9bfp-1022,
0x1.9a1ce7de93292p-1022,
0x1.9b0bc0efd62a3p-1022,
0x1.980e7f1deba03p-1022,
0x1.992e0ecd50281p-1022,
0x1.94927ba9eac4bp-1022,
0x1.958154bb2dc5cp-1022,
0x1.96702dcc70c6dp-1022,
0x1.975f06ddb3c7ep-1022,
0x1.9c39fad22454p-1022,
0x1.96a0e46a924dap-1022,
0x1.9a5c48af9e51ep-1022,
0x1.95c0b58c38ee8p-1022,
0x1.9d28d3e367551p-1022,
0x1.996d6f9e5b50dp-1022,
0x1.9b4b21c0e152fp-1022,
0x1.94d1dc7af5ed7p-1022,
0x1.978fbd7bd54ebp-1022,
0x1.9c795ba32f7ccp-1022,
0x1.96e0453b9d766p-1022,
0x1.95f16c2a5a755p-1022,
0x1.9a9ba980a97aap-1022,
0x1.99acd06f66799p-1022,
0x1.97cf1e4ce0777p-1022,
0x1.9caa124151039p-1022,
0x1.9b8a8291ec7bbp-1022,
0x1.9d98eb529404ap-1022,
0x1.987e968d184fcp-1022,
0x1.9e17acf4aa562p-1022,
0x1.99ec314071a25p-1022,
0x1.9ce973125c2c5p-1022,
0x1.9bbb39300e028p-1022,
0x1.9e486392cbdcfp-1022,
0x1.9dd84c239f2d6p-1022,
0x1.98bdf75e23788p-1022,
0x1.9e87c463d705bp-1022,
0x1.9ec72534e22e7p-1022,
0x1.a3e179fa5de35p-1022,
0x1.9f068605ed573p-1022,
0x1.a2f2a0e91ae24p-1022,
0x1.a6debbcc486d5p-1022,
0x1.a203c7d7d7e13p-1022,
0x1.a02615b551df1p-1022,
0x1.a114eec694e02p-1022,
0x1.a5efe2bb056c4p-1022,
0x1.a50109a9c26b3p-1022,
0x1.9f373ca40edep-1022,
0x1.a1544f97a008ep-1022,
0x1.a24328a8e309fp-1022,
0x1.a06576865d07dp-1022,
0x1.9f769d751a06cp-1022,
0x1.a33201ba260bp-1022,
0x1.a8fbcebfd9983p-1022,
0x1.a273df470490cp-1022,
0x1.a45191698a92ep-1022,
0x1.a193b068ab31ap-1022,
0x1.a5406a7acd93fp-1022,
0x1.a71e1c9d53961p-1022,
0x1.a0a4d75768309p-1022,
0x1.a62f438c1095p-1022,
0x1.a362b8584791dp-1022,
0x1.9fb5fe46252f8p-1022,
0x1.a490f23a95bbap-1022,
0x1.a0d58df589b76p-1022,
0x1.a80cf5ae96972p-1022,
0x1.a57fcb4bd8bcbp-1022,
0x1.a75d7d6e5ebedp-1022,
0x1.a2b340180fb98p-1022,
0x1.a1c46706ccb87p-1022,
0x1.a5bf2c1ce3e57p-1022,
0x1.a3a2192952ba9p-1022,
0x1.a96be62f0647cp-1022,
0x1.a84c567fa1bfep-1022,
0x1.a4d0530ba0e46p-1022,
0x1.a66ea45d1bbdcp-1022,
0x1.a9ab470011708p-1022,
0x1.a78e340c8045ap-1022,
0x1.a87d0d1dc346bp-1022,
0x1.a7cd94dd8b6e6p-1022,
0x1.a8bc6deece6f7p-1022,
0x1.aec59bc58d256p-1022,
0x1.aad980e25f9a5p-1022,
0x1.a9eaa7d11c994p-1022,
0x1.add6c2b44a245p-1022,
0x1.b1c2dd9777af6p-1022,
0x1.ace7e9a307234p-1022,
0x1.ab0a378081212p-1022,
0x1.abf91091c4223p-1022,
0x1.aa1b5e6f3e201p-1022,
0x1.9244b2183813p-1022,
0x1.ab4998518c49ep-1022,
0x1.af04fc96984e2p-1022,
0x1.927568b65999dp-1022,
0x1.aa5abf404948dp-1022,
0x1.ae162385554d1p-1022,
0x1.ac387162cf4afp-1022,
0x1.ad274a74124cp-1022,
0x1.af35b334b9d4fp-1022,
0x1.92b4c98764c29p-1022,
0x1.b2023e6882d82p-1022,
0x1.b2f11779c5d93p-1022,
0x1.aa9a201154719p-1022,
0x1.ab88f9229772ap-1022,
0x1.ae46da2376d3ep-1022,
0x1.b0248c45fcd6p-1022,
0x1.af751405c4fdbp-1022,
0x1.92f42a586feb5p-1022,
0x1.ac77d233da73bp-1022,
0x1.b3dff08b08da4p-1022,
0x1.ae863af481fcap-1022,
0x1.b063ed1707fecp-1022,
0x1.b2419f398e00ep-1022,
0x1.ad66ab451d74cp-1022,
0x1.b330784ad101fp-1022,
0x1.aca888d1fbfa8p-1022,
0x1.afb474d6d0267p-1022,
0x1.b3612ee8f288cp-1022,
0x1.b0a34de813278p-1022,
0x1.b41f515c1403p-1022,
0x1.ad9761e33efb9p-1022,
0x1.b3a08fb9fdb18p-1022,
0x1.b45007fa3589dp-1022,
0x1.b2b1b6a8bab07p-1022,
0x1.b48f68cb40b29p-1022,
0x1.b9a9bd90bc677p-1022,
0x1.b5bda2ad8edc6p-1022,
0x1.b4cec99c4bdb5p-1022,
0x1.b5ee594bb0633p-1022,
0x1.b8bae47f79666p-1022,
0x1.bca6ff62a6f17p-1022,
0x1.b62dba1cbb8bfp-1022,
0x1.b6dd325cf3644p-1022,
0x1.b7cc0b6e36655p-1022,
0x1.b66d1aedc6b4bp-1022,
0x1.b53ee10b788aep-1022,
0x1.b6ac7bbed1dd7p-1022,
0x1.b71c932dfe8dp-1022,
0x1.b8fa4550848f2p-1022,
0x1.bad7f7730a914p-1022,
0x1.b9e91e61c7903p-1022,
0x1.b80b6c3f418e1p-1022,
0x1.b75bf3ff09b5cp-1022,
0x1.b57e41dc83b3ap-1022,
0x1.bb08ae112c181p-1022,
0x1.b939a6218fb7ep-1022,
0x1.bbf787226f192p-1022,
0x1.b84acd104cb6dp-1022,
0x1.ba19d4ffe917p-1022,
0x1.bce66033b21a3p-1022,
0x1.bdd53944f51b4p-1022,
0x1.b96a5cbfb13ebp-1022,
0x1.bb480ee23740dp-1022,
0x1.b78caa9d2b3c9p-1022,
0x1.bc36e7f37a41ep-1022,
0x1.ba5935d0f43fcp-1022,
0x1.b87b83ae6e3dap-1022,
0x1.bd25c104bd42fp-1022,
0x1.bec41256381c5p-1022,
0x1.be149a160044p-1022,
0x1.ba9896a1ff688p-1022,
0x1.bb876fb342699p-1022,
0x1.bc7648c4856aap-1022,
0x1.c48ddf5beba98p-1022,
0x1.bd6521d5c86bbp-1022,
0x1.bf03732743451p-1022,
0x1.bd95d873e9f28p-1022,
0x1.bf3429c564cbep-1022,
0x1.be84b1852cf39p-1022,
0x1.bf738a966ff4ap-1022,
0x1.bfb2eb677b1d6p-1022,
0x1.bff24c3886462p-1022,
0x1.c0a1c478be1e7p-1022,
0x1.c02302d6a7ccfp-1022,
0x1.c39f064aa8a87p-1022,
0x1.c06263a7b2f5bp-1022,
0x1.c2b02d3965a76p-1022,
0x1.c1c1542822a65p-1022,
0x1.c111dbe7eacep-1022,
0x1.c6aaf24f7cd46p-1022,
0x1.c200b4f92dcf1p-1022,
0x1.c2ef8e0a70d02p-1022,
0x1.c3de671bb3d13p-1022,
0x1.c4cd402cf6d24p-1022,
0x1.c5bc193e39d35p-1022,
0x1.c1513cb8f5f6cp-1022,
0x1.c24015ca38f7dp-1022,
0x1.c32eeedb7bf8ep-1022,
0x1.c7ca81fee15c4p-1022,
0x1.c6dba8ed9e5b3p-1022,
0x1.c41dc7ecbef9fp-1022,
0x1.c8b95b10245d5p-1022,
0x1.c5eccfdc5b5a2p-1022,
0x1.c1909d8a011f8p-1022,
0x1.c50ca0fe01fbp-1022,
0x1.c27f769b44209p-1022,
0x1.c9a83421675e6p-1022,
0x1.c809e2cfec85p-1022,
0x1.c35fa5799d7fbp-1022,
0x1.c44e7e8ae080cp-1022,
0x1.c71b09bea983fp-1022,
0x1.c53d579c2381dp-1022,
0x1.c62c30ad6682ep-1022,
0x1.c8f8bbe12f861p-1022,
0x1.c84943a0f7adcp-1022,
0x1.c75a6a8fb4acbp-1022,
0x1.c66b917e71abap-1022,
0x1.c57cb86d2eaa9p-1022,
0x1.c9e794f272872p-1022,
0x1.c9381cb23aaedp-1022,
0x1.c879fa3f19349p-1022,
0x1.c968d3505c35ap-1022,
0x1.ca57ac619f36bp-1022,
0x1.b0d4048634ae5p-1022,
0x1.cb85e643ed608p-1022,
0x1.b11365573fd71p-1022,
0x1.b152c6284affdp-1022,
0x1.ce832815d7ea8p-1022,
0x1.b19226f956289p-1022,
0x1.cd944f0494e97p-1022,
0x1.cbc54714f8894p-1022,
0x1.d27ded2bef178p-1022,
0x1.cbf5fdb31a101p-1022,
0x1.cce4d6c45d112p-1022,
0x1.d18f141aac167p-1022,
0x1.cdd3afd5a0123p-1022,
0x1.cec288e6e3134p-1022,
0x1.d0a03b0969156p-1022,
0x1.cfb161f826145p-1022,
0x1.cd2437956839ep-1022,
0x1.cc355e842538dp-1022,
0x1.ce1310a6ab3afp-1022,
0x1.d39d7cdb539f6p-1022,
0x1.d2aea3ca109e5p-1022,
0x1.cf01e9b7ee3cp-1022,
0x1.cff0c2c9313d1p-1022,
0x1.d1bfcab8cd9d4p-1022,
0x1.ce527177b663bp-1022,
0x1.cc74bf5530619p-1022,
0x1.cd6398667362ap-1022,
0x1.d0df9bda743e2p-1022,
0x1.d48c55ec96a07p-1022,
0x1.cf32a0560fc2dp-1022,
0x1.d110527895c4fp-1022,
0x1.d3dcddac5ec82p-1022,
0x1.d2ee049b1bc71p-1022,
0x1.d021796752c3ep-1022,
0x1.d1ff2b89d8c6p-1022,
0x1.cf7201271aeb9p-1022,
0x1.d41c3e7d69f0ep-1022,
0x1.d060da385decap-1022,
0x1.d32d656c26efdp-1022,
0x1.d4cbb6bda1c93p-1022,
0x1.d14fb349a0edbp-1022,
0x1.d23e8c5ae3eecp-1022,
0x1.d44cf51b8b77bp-1022,
0x1.d57b2efdd9a18p-1022,
0x1.d50b178eacf1fp-1022,
0x1.d53bce2cce78cp-1022,
0x1.d5ba8fcee4ca4p-1022,
0x1.de50e808615aap-1022,
0x1.d66a080f1ca29p-1022,
0x1.d62aa73e1179dp-1022,
0x1.d96749e1072c9p-1022,
0x1.d6a968e027cb5p-1022,
0x1.d79841f16acc6p-1022,
0x1.dd620ef71e599p-1022,
0x1.d6da1f7e49522p-1022,
0x1.dc7335e5db588p-1022,
0x1.da9583c355566p-1022,
0x1.d7c8f88f8c533p-1022,
0x1.d8b7d1a0cf544p-1022,
0x1.d719804f547aep-1022,
0x1.db845cd498577p-1022,
0x1.d9a6aab212555p-1022,
0x1.de819ea682e17p-1022,
0x1.d8085960977bfp-1022,
0x1.dad4e494607f2p-1022,
0x1.dd92c5953fe06p-1022,
0x1.d9e60b831d7e1p-1022,
0x1.d758e1205fa3ap-1022,
0x1.dbc3bda5a3803p-1022,
0x1.d847ba31a2a4bp-1022,
0x1.d8f73271da7dp-1022,
0x1.dec0ff778e0a3p-1022,
0x1.e05f50c908e39p-1022,
0x1.dbf47443c507p-1022,
0x1.dce34d5508081p-1022,
0x1.db059b328205fp-1022,
0x1.ddd226664b092p-1022,
0x1.df7077b7c5e28p-1022,
0x1.da256c5428a6dp-1022,
0x1.df0060489932fp-1022,
0x1.db44fc038d2ebp-1022,
0x1.d9369342e5a5cp-1022,
0x1.dc33d514d02fcp-1022,
0x1.da5622f24a2dap-1022,
0x1.de1187375631ep-1022,
0x1.dd22ae261330dp-1022,
0x1.dfafd888d10b4p-1022,
0x1.e09eb19a140c5p-1022,
0x1.ca970d32aa5f7p-1022,
0x1.dfef3959dc34p-1022,
0x1.e0de126b1f351p-1022,
0x1.e01feff7fdbadp-1022,
0x1.e10ec90940bbep-1022,
0x1.e14e29da4be4ap-1022,
0x1.cad66e03b5883p-1022,
0x1.cb0724a1d70fp-1022,
0x1.cb468572e237cp-1022,
0x1.e18d8aab570d6p-1022,
0x1.e27c63bc9a0e7p-1022,
0x1.e84630c24d9bap-1022,
0x1.e2ad1a5abb954p-1022,
0x1.e36b3ccddd0f8p-1022,
0x1.e75757b10a9a9p-1022,
0x1.e2ec7b2bc6bep-1022,
0x1.e6687e9fc7998p-1022,
0x1.e1fda21a83bcfp-1022,
0x1.e48acc7d41976p-1022,
0x1.e579a58e84987p-1022,
0x1.e39bf36bfe965p-1022,
0x1.ea549982f5249p-1022,
0x1.e32bdbfcd1e6cp-1022,
0x1.e796b88215c35p-1022,
0x1.e4ca2d4e4cc02p-1022,
0x1.e6a7df70d2c24p-1022,
0x1.e5b9065f8fc13p-1022,
0x1.e8b648317a4b3p-1022,
0x1.e23d02eb8ee5bp-1022,
0x1.e3db543d09bf1p-1022,
0x1.e6d8960ef4491p-1022,
0x1.e7c76f20374a2p-1022,
0x1.e5f867309ae9fp-1022,
0x1.ea93fa54004d5p-1022,
0x1.e5098e1f57e8ep-1022,
0x1.e41ab50e14e7dp-1022,
0x1.e965c071b2238p-1022,
0x1.ead35b250b761p-1022,
0x1.e8f5a9028573fp-1022,
0x1.e53a44bd796fbp-1022,
0x1.e717f6dfff71dp-1022,
0x1.e806cff14272ep-1022,
0x1.e6291dcebc70cp-1022,
0x1.eb4372943825ap-1022,
0x1.e9a52142bd4c4p-1022,
0x1.e93509d3909cbp-1022,
0x1.e9e48213c875p-1022,
0x1.ec324ba57b26bp-1022,
0x1.ea23e2e4d39dcp-1022,
0x1.eb82d365434e6p-1022,
0x1.ebc234364e772p-1022,
0x1.ebf2ead46ffdfp-1022,
0x1.f32a528d7cddbp-1022,
0x1.ec71ac76864f7p-1022,
0x1.ef3e37aa4f52ap-1022,
0x1.ed608587c9508p-1022,
0x1.ee4f5e990c519p-1022,
0x1.ecb10d4791783p-1022,
0x1.f23b797c39dcap-1022,
0x1.f369b35e88067p-1022,
0x1.f14ca06af6db9p-1022,
0x1.ef6eee4870d97p-1022,
0x1.ee8015372dd86p-1022,
0x1.f05dc759b3da8p-1022,
0x1.f39a69fca98d4p-1022,
0x1.ece1c3e5b2ffp-1022,
0x1.edd09cf6f6001p-1022,
0x1.efae4f197c023p-1022,
0x1.ed2124b6be27cp-1022,
0x1.f18c013c02045p-1022,
0x1.f3d9cacdb4b6p-1022,
0x1.f27ada4d45056p-1022,
0x1.eebf760839012p-1022,
0x1.f09d282abf034p-1022,
0x1.f538bb4e2466ap-1022,
0x1.f489430dec8e5p-1022,
0x1.f4192b9ebfdecp-1022,
0x1.ee0ffdc80128dp-1022,
0x1.efedafea872afp-1022,
0x1.eefed6d94429ep-1022,
0x1.f1cb620d0d2d1p-1022,
0x1.f0dc88fbca2cp-1022,
0x1.f2ab90eb668c3p-1022,
0x1.f10d3f99ebb2dp-1022,
0x1.f1fc18ab2eb3ep-1022,
0x1.f4c8a3def7b71p-1022,
0x1.f5781c1f2f8f6p-1022,
0x1.f2eaf1bc71b4fp-1022,
0x1.f7166d70aa68cp-1022,
0x1.f627945f6767bp-1022,
0x1.f50804b002dfdp-1022,
0x1.f5b77cf03ab82p-1022,
0x1.f5f6ddc145e0ep-1022,
0x1.f666f53072907p-1022,
0x1.fb113286c195cp-1022,
0x1.f6a656017db93p-1022,
0x1.f844a752f8929p-1022,
0x1.fa2259757e94bp-1022,
0x1.f884082403bb5p-1022,
0x1.f755ce41b5918p-1022,
0x1.fb41e924e31c9p-1022,
0x1.fe0e7458ac1fcp-1022,
0x1.f93380643b93ap-1022,
0x1.fd1f9b47691ebp-1022,
0x1.f8b4bec225422p-1022,
0x1.fb8149f5ee455p-1022,
0x1.f7952f12c0ba4p-1022,
0x1.fc30c236261dap-1022,
0x1.fbc0aac6f96e1p-1022,
0x1.f8f41f93306aep-1022,
0x1.f7c5e5b0e2411p-1022,
0x1.fa531013a01b8p-1022,
0x1.fd5efc1874477p-1022,
0x1.f9a397d368433p-1022,
0x1.fa9270e4ab444p-1022,
0x1.fc70230731466p-1022,
0x1.f8054681ed69dp-1022,
0x1.ff3cae3afa499p-1022,
0x1.fd9e5ce97f703p-1022,
0x1.fe4dd529b7488p-1022,
0x1.fcaf83d83c6f2p-1022,
0x1.fdcf1387a0f7p-1022,
0x1.fad1d1b5b66dp-1022,
0x1.f9e2f8a4736bfp-1022,
0x1.fe7e8bc7d8cf5p-1022,
0x1.ff6d64d91bd06p-1022,
0x1.febdec98e3f81p-1022,
0x1.fce03a765df5fp-1022,
0x1.ffacc5aa26f92p-1022,
0x1.fefd4d69ef20dp-1022,
0x1.ffec267b3221ep-1022,
};

/* check worst cases in [2^-1022, 2^-106) from those in exp2m1.wc for the
   binade 2^-1022 <= x < 2^-1021 */
static void
check_tiny (void)
{
  for (int i = 0; i < N_WORST; i++)
  {
    double x = T[i];
    for (int e = -1020; e <= -106; e++)
    {
      // check binade 2^(e-1) <= |x| < 2^e
      check (ldexp (x, e + 1021));
      check (ldexp (-x, e + 1021));
    }
  }
}

int
main (int argc, char *argv[])
{
  while (argc >= 2)
    {
      if (strcmp (argv[1], "--rndn") == 0)
        {
          rnd = 0;
          argc --;
          argv ++;
        }
      else if (strcmp (argv[1], "--rndz") == 0)
        {
          rnd = 1;
          argc --;
          argv ++;
        }
      else if (strcmp (argv[1], "--rndu") == 0)
        {
          rnd = 2;
          argc --;
          argv ++;
        }
      else if (strcmp (argv[1], "--rndd") == 0)
        {
          rnd = 3;
          argc --;
          argv ++;
        }
      else if (strcmp (argv[1], "--verbose") == 0)
        {
          verbose = 1;
          argc --;
          argv ++;
        }
      else
        {
          fprintf (stderr, "Error, unknown option %s\n", argv[1]);
          exit (1);
        }
    }
  ref_init ();
  ref_fesetround (rnd);

  printf ("Checking tiny worst cases\n");
  check_tiny ();

  printf ("Checking random values\n");
#define N 1000000000UL /* total number of tests */

  unsigned int seed = getpid ();
  srand (seed);
  
#pragma omp parallel for
  for (uint64_t n = 0; n < N; n++)
  {
    ref_init ();
    ref_fesetround (rnd);
    double x;
    x = get_random ();
    check (x);
  }

  return 0;
}

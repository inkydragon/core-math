/* Check log10p1 on random inputs.

Copyright (c) 2022-2023 Paul Zimmermann, Inria.

This file is part of the CORE-MATH project
(https://core-math.gitlabpages.inria.fr/).

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
*/

#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <string.h>
#include <fenv.h>
#include <math.h>
#include <sys/types.h>
#include <unistd.h>
#include <omp.h>

int ref_init (void);
int ref_fesetround (int);

double cr_log10p1 (double);
double ref_log10p1 (double);

int rnd1[] = { FE_TONEAREST, FE_TOWARDZERO, FE_UPWARD, FE_DOWNWARD };

int rnd = 0;
int verbose = 0;

static inline uint64_t
asuint64 (double f)
{
  union
  {
    double f;
    uint64_t i;
  } u = {f};
  return u.i;
}

typedef union {double f; uint64_t u;} b64u64_u;

static double
get_random ()
{
  b64u64_u v;
  long l;
  v.u = rand ();
  v.u |= (uint64_t) rand () << 31;
  v.u |= (uint64_t) rand () << 62;
  return v.f;
}

static void
check (double x)
{
  int bug;
  double y1 = ref_log10p1 (x);
  fesetround (rnd1[rnd]);
  double y2 = cr_log10p1 (x);
  if (isnan (y1))
    bug = !isnan (y2);
  else if (isnan (y2))
    bug = !isnan (y1);
  else
    bug = asuint64 (y1) != asuint64 (y2);
  if (bug)
  {
    printf ("FAIL x=%la ref=%la z=%la\n", x, y1, y2);
    fflush (stdout);
    exit (1);
  }
}

#define N_WORST 1028

/* worst cases in [2^-1020,2^-1019) */
static double T[N_WORST] = {
0x1.0052503074b2fp-1020,
0x1.0091c2306330ap-1020,
0x1.002905af44128p-1020,
0x1.00fa7eb1824ecp-1020,
0x1.01cbf7b3c08bp-1020,
0x1.01633b32a16cep-1020,
0x1.0234b434dfa92p-1020,
0x1.029d70b5fec74p-1020,
0x1.03062d371de56p-1020,
0x1.036ee9b83d038p-1020,
0x1.03d7a6395c21ap-1020,
0x1.044062ba7b3fcp-1020,
0x1.04a91f3b9a5dep-1020,
0x1.0511dbbcb97cp-1020,
0x1.05514dbca7f9bp-1020,
0x1.057a983dd89a2p-1020,
0x1.05ba0a3dc717dp-1020,
0x1.05e354bef7b84p-1020,
0x1.068b834005541p-1020,
0x1.06b4cdc135f48p-1020,
0x1.0622c6bee635fp-1020,
0x1.064c114016d66p-1020,
0x1.06f43fc124723p-1020,
0x1.071d8a425512ap-1020,
0x1.07ef0344934eep-1020,
0x1.075cfc4243905p-1020,
0x1.078646c37430cp-1020,
0x1.07c5b8c362ae7p-1020,
0x1.082e754481cc9p-1020,
0x1.0857bfc5b26dp-1020,
0x1.089731c5a0eabp-1020,
0x1.08c07c46d18b2p-1020,
0x1.08ffee46c008dp-1020,
0x1.0968aac7df26fp-1020,
0x1.0991f5490fc76p-1020,
0x1.092938c7f0a94p-1020,
0x1.09d16748fe451p-1020,
0x1.09fab1ca2ee58p-1020,
0x1.0a3a23ca1d633p-1020,
0x1.0a636e4b4e03ap-1020,
0x1.0aa2e04b3c815p-1020,
0x1.0acc2acc6d21cp-1020,
0x1.0b0b9ccc5b9f7p-1020,
0x1.0b34e74d8c3fep-1020,
0x1.0b74594d7abd9p-1020,
0x1.0b9da3ceab5ep-1020,
0x1.0bdd15ce99dbbp-1020,
0x1.0c06604fca7c2p-1020,
0x1.0cae8ed0d817fp-1020,
0x1.0c45d24fb8f9dp-1020,
0x1.0c6f1cd0e99a4p-1020,
0x1.0cd7d95208b86p-1020,
0x1.0d174b51f7361p-1020,
0x1.0d4095d327d68p-1020,
0x1.0d8007d316543p-1020,
0x1.0de8c45435725p-1020,
0x1.0e5180d554907p-1020,
0x1.0eba3d5673ae9p-1020,
0x1.0f22f9d792ccbp-1020,
0x1.0f8bb658b1eadp-1020,
0x1.0ff472d9d108fp-1020,
0x1.105d2f5af0271p-1020,
0x1.10c5ebdc0f453p-1020,
0x1.112ea85d2e635p-1020,
0x1.119764de4d817p-1020,
0x1.1200215f6c9f9p-1020,
0x1.12a84fe07a3b6p-1020,
0x1.123f935f5b1d4p-1020,
0x1.12d19a61aadbdp-1020,
0x1.1268dde08bbdbp-1020,
0x1.13110c6199598p-1020,
0x1.133a56e2c9f9fp-1020,
0x1.1379c8e2b877ap-1020,
0x1.13a31363e9181p-1020,
0x1.13e28563d795cp-1020,
0x1.144b41e4f6b3ep-1020,
0x1.14748c6627545p-1020,
0x1.140bcfe508363p-1020,
0x1.14b3fe6615d2p-1020,
0x1.14dd48e746727p-1020,
0x1.151cbae734f02p-1020,
0x1.15aec1e984aebp-1020,
0x1.1546056865909p-1020,
0x1.15857768540e4p-1020,
0x1.15ee33e9732c6p-1020,
0x1.16177e6aa3ccdp-1020,
0x1.1656f06a924a8p-1020,
0x1.16803aebc2eafp-1020,
0x1.16bfacebb168ap-1020,
0x1.16e8f76ce2091p-1020,
0x1.1728696cd086cp-1020,
0x1.1751b3ee01273p-1020,
0x1.179125edefa4ep-1020,
0x1.17ba706f20455p-1020,
0x1.17f9e26f0ec3p-1020,
0x1.18232cf03f637p-1020,
0x1.18cb5b714cff4p-1020,
0x1.18629ef02de12p-1020,
0x1.188be9715e819p-1020,
0x1.18f4a5f27d9fbp-1020,
0x1.193417f26c1d6p-1020,
0x1.195d62739cbddp-1020,
0x1.199cd4738b3b8p-1020,
0x1.19c61ef4bbdbfp-1020,
0x1.1a0590f4aa59ap-1020,
0x1.1a6e4d75c977cp-1020,
0x1.1a2edb75dafa1p-1020,
0x1.1ad709f6e895ep-1020,
0x1.1b3fc67807b4p-1020,
0x1.1ba882f926d22p-1020,
0x1.1c113f7a45f04p-1020,
0x1.1c79fbfb650e6p-1020,
0x1.1ce2b87c842c8p-1020,
0x1.1d4b74fda34aap-1020,
0x1.1db4317ec268cp-1020,
0x1.1e1cedffe186ep-1020,
0x1.1e85aa8100a5p-1020,
0x1.1eee67021fc32p-1020,
0x1.1f2dd9020e40dp-1020,
0x1.1f5723833ee14p-1020,
0x1.1f9695832d5efp-1020,
0x1.1fbfe0045dff6p-1020,
0x1.1fff52044c7d1p-1020,
0x1.20680e856b9b3p-1020,
0x1.209159069c3bap-1020,
0x1.20289c857d1d8p-1020,
0x1.20d0cb068ab95p-1020,
0x1.20fa1587bb59cp-1020,
0x1.21398787a9d77p-1020,
0x1.21cb8e89f996p-1020,
0x1.2162d208da77ep-1020,
0x1.21a24408c8f59p-1020,
0x1.220b0089e813bp-1020,
0x1.22344b0b18b42p-1020,
0x1.2273bd0b0731dp-1020,
0x1.229d078c37d24p-1020,
0x1.22dc798c264ffp-1020,
0x1.2305c40d56f06p-1020,
0x1.2345360d456e1p-1020,
0x1.236e808e760e8p-1020,
0x1.23adf28e648c3p-1020,
0x1.23d73d0f952cap-1020,
0x1.2416af0f83aa5p-1020,
0x1.243ff990b44acp-1020,
0x1.24e82811c1e69p-1020,
0x1.247f6b90a2c87p-1020,
0x1.24a8b611d368ep-1020,
0x1.25117292f287p-1020,
0x1.2550e492e104bp-1020,
0x1.257a2f1411a52p-1020,
0x1.25b9a1140022dp-1020,
0x1.25e2eb9530c34p-1020,
0x1.26225d951f40fp-1020,
0x1.268b1a163e5f1p-1020,
0x1.26b464976eff8p-1020,
0x1.264ba8164fe16p-1020,
0x1.2896c89bd9f5bp-1020,
0x1.28c0131d0a962p-1020,
0x1.26ca8c162cdccp-1020,
0x1.26f3d6975d7d3p-1020,
0x1.271d21188e1dap-1020,
0x1.293ef71ce7918p-1020,
0x1.2968419e1831fp-1020,
0x1.29918c1f48d26p-1020,
0x1.279c05186b19p-1020,
0x1.27c54f999bb97p-1020,
0x1.27ee9a1acc59ep-1020,
0x1.2a10701f25cdcp-1020,
0x1.286d7e1aa9554p-1020,
0x1.2c84db25e0828p-1020,
0x1.2cae25a71122fp-1020,
0x1.2cd7702841c36p-1020,
0x1.2ae1e921640ap-1020,
0x1.2b0b33a294aa7p-1020,
0x1.2b347e23c54aep-1020,
0x1.2d5654281ebecp-1020,
0x1.2bb36223a2464p-1020,
0x1.2d7f9ea94f5f3p-1020,
0x1.2bdcaca4d2e6bp-1020,
0x1.2c05f72603872p-1020,
0x1.2a39baa0566e3p-1020,
0x1.2a630521870eap-1020,
0x1.2e5117ab8d9b7p-1020,
0x1.2e7a622cbe3bep-1020,
0x1.3072edafe70f5p-1020,
0x1.309c383117afcp-1020,
0x1.30c582b248503p-1020,
0x1.2ecffbab6a96dp-1020,
0x1.2ef9462c9b374p-1020,
0x1.2f2290adcbd7bp-1020,
0x1.2f4bdb2efc782p-1020,
0x1.2da8e92a7fffap-1020,
0x1.2fa174ada8d31p-1020,
0x1.2fcabf2ed9738p-1020,
0x1.2e27cd2a5cfbp-1020,
0x1.2ff409b00a13fp-1020,
0x1.301d54313ab46p-1020,
0x1.3215dfb46387dp-1020,
0x1.323f2a3594284p-1020,
0x1.326874b6c4c8bp-1020,
0x1.30eecd3378f0ap-1020,
0x1.32e758b6a1c41p-1020,
0x1.314466b2254b9p-1020,
0x1.3310a337d2648p-1020,
0x1.3339edb90304fp-1020,
0x1.316db13355ecp-1020,
0x1.3196fbb4868c7p-1020,
0x1.33e21c3a10a0cp-1020,
0x1.33b8d1b8e0005p-1020,
0x1.340b66bb41413p-1020,
0x1.362d3cbf9ab51p-1020,
0x1.36568740cb558p-1020,
0x1.367fd1c1fbf5fp-1020,
0x1.348a4abb1e3c9p-1020,
0x1.34b3953c4eddp-1020,
0x1.34dcdfbd7f7d7p-1020,
0x1.36feb5c1d8f15p-1020,
0x1.37514ac43a323p-1020,
0x1.35850e3e8d194p-1020,
0x1.355bc3bd5c78dp-1020,
0x1.372800430991cp-1020,
0x1.35ae58bfbdb9bp-1020,
0x1.37d02ec4172d9p-1020,
0x1.37f9794547cep-1020,
0x1.3822c3c6786e7p-1020,
0x1.3a4499cad1e25p-1020,
0x1.3a6de44c0282cp-1020,
0x1.3a972ecd33233p-1020,
0x1.38a1a7c65569dp-1020,
0x1.38caf247860a4p-1020,
0x1.38f43cc8b6aabp-1020,
0x1.397320c893a61p-1020,
0x1.399c6b49c4468p-1020,
0x1.39c5b5caf4e6fp-1020,
0x1.3b1612cd101e9p-1020,
0x1.3d8a7dd3cad35p-1020,
0x1.3db3c854fb73cp-1020,
0x1.3ddd12d62c143p-1020,
0x1.3bbe414e1dba6p-1020,
0x1.3be78bcf4e5adp-1020,
0x1.3c10d6507efb4p-1020,
0x1.3c3a20d1af9bbp-1020,
0x1.3e32ac54d86f2p-1020,
0x1.3c8fba505bf6ap-1020,
0x1.3e5bf6d6090f9p-1020,
0x1.3b3f5d4e40bfp-1020,
0x1.3ce24f52bd378p-1020,
0x1.3cb904d18c971p-1020,
0x1.3d0b99d3edd7fp-1020,
0x1.3b68a7cf715f7p-1020,
0x1.3d6133529a32ep-1020,
0x1.4178905dd1602p-1020,
0x1.41a1dadf02009p-1020,
0x1.3fd59e5954e7ap-1020,
0x1.3ffee8da85881p-1020,
0x1.41cb256032a1p-1020,
0x1.3e85415739bp-1020,
0x1.4028335bb6288p-1020,
0x1.40a7175b9323ep-1020,
0x1.40d061dcc3c45p-1020,
0x1.3f04255716ab6p-1020,
0x1.3f2d6fd8474bdp-1020,
0x1.40f9ac5df464cp-1020,
0x1.3f56ba5977ec4p-1020,
0x1.4344cce37e791p-1020,
0x1.436e1764af198p-1020,
0x1.43ecfb648c14ep-1020,
0x1.441645e5bcb55p-1020,
0x1.424a09600f9c6p-1020,
0x1.427353e1403cdp-1020,
0x1.443f9066ed55cp-1020,
0x1.429c9e6270dd4p-1020,
0x1.431b82624dd8ap-1020,
0x1.44be7466ca512p-1020,
0x1.44e7bee7faf19p-1020,
0x1.451109692b92p-1020,
0x1.4732df6d8505ep-1020,
0x1.475c29eeb5a65p-1020,
0x1.4785746fe646cp-1020,
0x1.458fed69088d6p-1020,
0x1.45b937ea392ddp-1020,
0x1.45e2826b69ce4p-1020,
0x1.4804586fc3422p-1020,
0x1.482da2f0f3e29p-1020,
0x1.468ab0ec776a1p-1020,
0x1.4661666b46c9ap-1020,
0x1.4856ed722483p-1020,
0x1.46b3fb6da80a8p-1020,
0x1.4928667462bf4p-1020,
0x1.48ac86f0d0ddfp-1020,
0x1.4b20f1f78b92bp-1020,
0x1.4b4a3c78bc332p-1020,
0x1.4b7386f9ecd39p-1020,
0x1.497dfff30f1a3p-1020,
0x1.49a74a743fbaap-1020,
0x1.49d094f5705b1p-1020,
0x1.4b9cd17b1d74p-1020,
0x1.49f9df76a0fb8p-1020,
0x1.48d5d172017e6p-1020,
0x1.4a4f78f54d567p-1020,
0x1.4a78c3767df6ep-1020,
0x1.4bf26af9c9cefp-1020,
0x1.48ff1bf3321edp-1020,
0x1.4aa20df7ae975p-1020,
0x1.4acb5878df37cp-1020,
0x1.4cc3e3fc080b3p-1020,
0x1.4ced2e7d38abap-1020,
0x1.4d1678fe694c1p-1020,
0x1.4c1bb57afa6f6p-1020,
0x1.4f384f02c2bffp-1020,
0x1.4d955cfe46477p-1020,
0x1.4f619983f3606p-1020,
0x1.4dbea77f76e7ep-1020,
0x1.4c44fffc2b0fdp-1020,
0x1.4de7f200a7885p-1020,
0x1.4e66d6008483bp-1020,
0x1.4e902081b5242p-1020,
0x1.4eb96b02e5c49p-1020,
0x1.527e330bbbb0fp-1020,
0x1.52a77d8cec516p-1020,
0x1.50db41073f387p-1020,
0x1.51048b886fd8ep-1020,
0x1.512dd609a0795p-1020,
0x1.4f8ae4052400dp-1020,
0x1.52d0c80e1cf1dp-1020,
0x1.50331286319cap-1020,
0x1.5009c80500fc3p-1020,
0x1.51acba097d74bp-1020,
0x1.51d6048aae152p-1020,
0x1.51ff4f0bdeb59p-1020,
0x1.505c5d07623d1p-1020,
0x1.54f29e127665bp-1020,
0x1.551be893a7062p-1020,
0x1.534fac0df9ed3p-1020,
0x1.55453314d7a69p-1020,
0x1.53a241105b2e1p-1020,
0x1.5378f68f2a8dap-1020,
0x1.559acc9384018p-1020,
0x1.5421251038297p-1020,
0x1.55c41714b4a1fp-1020,
0x1.55ed6195e5426p-1020,
0x1.544a6f9168c9ep-1020,
0x1.5473ba12996a5p-1020,
0x1.5616ac1715e2dp-1020,
0x1.5861cc9c9ff72p-1020,
0x1.566c4595c23dcp-1020,
0x1.588b171dd0979p-1020,
0x1.56959016f2de3p-1020,
0x1.56beda98237eap-1020,
0x1.56e82519541f1p-1020,
0x1.58e0b09c7cf28p-1020,
0x1.5909fb1dad92fp-1020,
0x1.57670919311a7p-1020,
0x1.573dbe98007ap-1020,
0x1.5933459ede336p-1020,
0x1.57b99e1b925b5p-1020,
0x1.5790539a61baep-1020,
0x1.580f379a3eb64p-1020,
0x1.5838821b6f56bp-1020,
0x1.5c2694a575e38p-1020,
0x1.5c4fdf26a683fp-1020,
0x1.5a83a2a0f96bp-1020,
0x1.5c7929a7d7246p-1020,
0x1.5aaced222a0b7p-1020,
0x1.5ad637a35aabep-1020,
0x1.59b2299ebb2ecp-1020,
0x1.59db741febcf3p-1020,
0x1.5cf80da7b41fcp-1020,
0x1.5b7e66246847bp-1020,
0x1.5b551ba337a74p-1020,
0x1.5a04bea11c6fap-1020,
0x1.5ba7b0a598e82p-1020,
0x1.5e1c1bac539cep-1020,
0x1.603df1b0ad10cp-1020,
0x1.5e9affac30984p-1020,
0x1.5d215828e4c03p-1020,
0x1.5ec44a2d6138bp-1020,
0x1.5d4aa2aa1560ap-1020,
0x1.5eed94ae91d92p-1020,
0x1.5f6c78ae6ed48p-1020,
0x1.5dc986a9f25cp-1020,
0x1.5df2d12b22fc7p-1020,
0x1.5f95c32f9f74fp-1020,
0x1.5fbf0db0d0156p-1020,
0x1.60673c31ddb13p-1020,
0x1.61e0e3b529894p-1020,
0x1.620a2e365a29bp-1020,
0x1.623378b78aca2p-1020,
0x1.609086b30e51ap-1020,
0x1.610f6ab2eb4dp-1020,
0x1.62b25cb767c58p-1020,
0x1.6289123637251p-1020,
0x1.62dba7389865fp-1020,
0x1.6161ffb54c8dep-1020,
0x1.6304f1b9c9066p-1020,
0x1.6138b5341bed7p-1020,
0x1.635a8b3875615p-1020,
0x1.63ad203ad6a23p-1020,
0x1.6383d5b9a601cp-1020,
0x1.63d66abc0742ap-1020,
0x1.65cef63f30161p-1020,
0x1.642c043ab39d9p-1020,
0x1.65f840c060b68p-1020,
0x1.66218b419156fp-1020,
0x1.64554ebbe43ep-1020,
0x1.647e993d14de7p-1020,
0x1.64a7e3be457eep-1020,
0x1.66a06f416e525p-1020,
0x1.6526c7be227a4p-1020,
0x1.64fd7d3cf1d9dp-1020,
0x1.66c9b9c29ef2cp-1020,
0x1.6550123f531abp-1020,
0x1.6771e843ac8e9p-1020,
0x1.66f30443cf933p-1020,
0x1.65795cc083bb2p-1020,
0x1.679b32c4dd2fp-1020,
0x1.67c47d460dcf7p-1020,
0x1.69e6534a67435p-1020,
0x1.6a0f9dcb97e3cp-1020,
0x1.68436145eacadp-1020,
0x1.6a38e84cc8843p-1020,
0x1.6895f6484c0bbp-1020,
0x1.686cabc71b6b4p-1020,
0x1.6914da4829071p-1020,
0x1.693e24c959a78p-1020,
0x1.69676f4a8a47fp-1020,
0x1.6d5581d490d4cp-1020,
0x1.6d7ecc55c1753p-1020,
0x1.6b89454ee3bbdp-1020,
0x1.6bb28fd0145c4p-1020,
0x1.6bdbda5144fcbp-1020,
0x1.6ab7cc4ca57f9p-1020,
0x1.6c5abe5121f81p-1020,
0x1.6b0a614f06c07p-1020,
0x1.6ae116cdd62p-1020,
0x1.6c8408d252988p-1020,
0x1.6cad53538338fp-1020,
0x1.6d2c375360345p-1020,
0x1.6dfdb0559e709p-1020,
0x1.711a49dd66c12p-1020,
0x1.7143945e97619p-1020,
0x1.6f7757d8ea48ap-1020,
0x1.6fa0a25a1ae91p-1020,
0x1.6e26fad6cf11p-1020,
0x1.6e504557ffb17p-1020,
0x1.6fc9ecdb4b898p-1020,
0x1.6ff3375c7c29fp-1020,
0x1.7048d0db2884ep-1020,
0x1.6ecf2957dcacdp-1020,
0x1.70721b5c59255p-1020,
0x1.709b65dd89c5cp-1020,
0x1.6ef873d90d4d4p-1020,
0x1.6f21be5a3dedbp-1020,
0x1.70c4b05eba663p-1020,
0x1.730fd0e4447a8p-1020,
0x1.716cdedfc802p-1020,
0x1.71962960f8a27p-1020,
0x1.71ebc2dfa4fd6p-1020,
0x1.738eb4e42175ep-1020,
0x1.73b7ff6552165p-1020,
0x1.723e57e2063e4p-1020,
0x1.72150d60d59ddp-1020,
0x1.73e149e682b6cp-1020,
0x1.7267a26336debp-1020,
0x1.72bd3be1e339ap-1020,
0x1.74602de65fb22p-1020,
0x1.72e6866313da1p-1020,
0x1.7489786790529p-1020,
0x1.74b2c2e8c0f3p-1020,
0x1.76d498ed1a66ep-1020,
0x1.76fde36e4b075p-1020,
0x1.7531a6e89dee6p-1020,
0x1.77272def7ba7cp-1020,
0x1.755af169ce8edp-1020,
0x1.75843beaff2f4p-1020,
0x1.76031feadc2aap-1020,
0x1.77a611ef58a32p-1020,
0x1.77cf5c7089439p-1020,
0x1.762c6a6c0ccb1p-1020,
0x1.7655b4ed3d6b8p-1020,
0x1.77f8a6f1b9e4p-1020,
0x1.7aebf5f851942p-1020,
0x1.7b15407982349p-1020,
0x1.794903f3d51bap-1020,
0x1.7b3e8afab2d5p-1020,
0x1.79724e7505bc1p-1020,
0x1.799b98f6365c8p-1020,
0x1.78778af196df6p-1020,
0x1.78a0d572c77fdp-1020,
0x1.7a1a7cf61357ep-1020,
0x1.78ca1ff3f8204p-1020,
0x1.7a43c77743f85p-1020,
0x1.7a6d11f87498cp-1020,
0x1.7c8ee7fcce0cap-1020,
0x1.7cb8327dfead1p-1020,
0x1.7ce17cff2f4d8p-1020,
0x1.7bbd6efa8fd06p-1020,
0x1.7d37167ddba87p-1020,
0x1.7eda08825820fp-1020,
0x1.7d6060ff0c48ep-1020,
0x1.7be6b97bc070dp-1020,
0x1.7d89ab803ce95p-1020,
0x1.7c1003fcf1114p-1020,
0x1.7db2f6016d89cp-1020,
0x1.7c659d7b9d6c3p-1020,
0x1.7e31da014a852p-1020,
0x1.7e088f8019e4bp-1020,
0x1.7e5b24827b259p-1020,
0x1.7e846f03abc6p-1020,
0x1.8249370c81b26p-1020,
0x1.807cfa86d4997p-1020,
0x1.7f03530388c16p-1020,
0x1.80a645080539ep-1020,
0x1.7f2c9d84b961dp-1020,
0x1.80cf8f8935da5p-1020,
0x1.7f55e805ea024p-1020,
0x1.7fab8184965d3p-1020,
0x1.814e738912d5bp-1020,
0x1.7fd4cc05c6fdap-1020,
0x1.7ffe1686f79e1p-1020,
0x1.8177be0a43762p-1020,
0x1.81a1088b74169p-1020,
0x1.821fec8b5111fp-1020,
0x1.8272818db252dp-1020,
0x1.849457920bc6bp-1020,
0x1.82f1658d8f4e3p-1020,
0x1.84bda2133c672p-1020,
0x1.831ab00ebfeeap-1020,
0x1.84e6ec946d079p-1020,
0x1.8343fa8ff08f1p-1020,
0x1.83ec2910fe2aep-1020,
0x1.83c2de8fcd8a7p-1020,
0x1.8565d0944a02fp-1020,
0x1.841573922ecb5p-1020,
0x1.858f1b157aa36p-1020,
0x1.85b86596ab43dp-1020,
0x1.882cd09d65f89p-1020,
0x1.86374996883f3p-1020,
0x1.86609417b8dfap-1020,
0x1.8689de98e9801p-1020,
0x1.8708c298c67b7p-1020,
0x1.87320d19f71bep-1020,
0x1.88abb49d42f3fp-1020,
0x1.875b579b27bc5p-1020,
0x1.88d4ff1e73946p-1020,
0x1.88fe499fa434dp-1020,
0x1.87da3b9b04b7bp-1020,
0x1.8803861c35582p-1020,
0x1.8bc84e250b448p-1020,
0x1.8bf198a63be4fp-1020,
0x1.8a255c208eccp-1020,
0x1.8c1ae3276c856p-1020,
0x1.8a4ea6a1bf6c7p-1020,
0x1.8c442da89d25dp-1020,
0x1.8a77f122f00cep-1020,
0x1.8aa13ba420ad5p-1020,
0x1.8953e31e508fcp-1020,
0x1.8af6d522cd084p-1020,
0x1.897d2d9f81303p-1020,
0x1.89a67820b1d0ap-1020,
0x1.8b496a252e492p-1020,
0x1.8b201fa3fda8bp-1020,
0x1.89cfc2a1e2711p-1020,
0x1.8b72b4a65ee99p-1020,
0x1.8c99c7274980cp-1020,
0x1.8cc311a87a213p-1020,
0x1.8e3cb92bc5f94p-1020,
0x1.8fdfab304271cp-1020,
0x1.8e6603acf699bp-1020,
0x1.8cec5c29aac1ap-1020,
0x1.8e8f4e2e273a2p-1020,
0x1.8d6b402987bdp-1020,
0x1.8d948aaab85d7p-1020,
0x1.8f0e322e04358p-1020,
0x1.8dbdd52be8fdep-1020,
0x1.8f377caf34d5fp-1020,
0x1.8f60c73065766p-1020,
0x1.91829d34beea4p-1020,
0x1.91abe7b5ef8abp-1020,
0x1.9008f5b173123p-1020,
0x1.91d53237202b2p-1020,
0x1.90324032a3b2ap-1020,
0x1.92541636fd268p-1020,
0x1.90da6eb3b14e7p-1020,
0x1.90b1243280aep-1020,
0x1.927d60b82dc6fp-1020,
0x1.9103b934e1eeep-1020,
0x1.92a6ab395e676p-1020,
0x1.93258f393b62cp-1020,
0x1.934ed9ba6c033p-1020,
0x1.9599fa3ff6178p-1020,
0x1.95c344c126b7fp-1020,
0x1.93f7083b799fp-1020,
0x1.95ec8f4257586p-1020,
0x1.942052bcaa3f7p-1020,
0x1.94499d3ddadfep-1020,
0x1.9378243b9ca3ap-1020,
0x1.94f1cbbee87bbp-1020,
0x1.94c8813db7db4p-1020,
0x1.964228c103b35p-1020,
0x1.966b73423453cp-1020,
0x1.951b1640191c2p-1020,
0x1.9694bdc364f43p-1020,
0x1.973cec44729p-1020,
0x1.976636c5a3307p-1020,
0x1.978f8146d3d0ep-1020,
0x1.96be08449594ap-1020,
0x1.99880cc9fca45p-1020,
0x1.97e51ac5802bdp-1020,
0x1.99b1574b2d44cp-1020,
0x1.980e6546b0cc4p-1020,
0x1.99daa1cc5de53p-1020,
0x1.9837afc7e16cbp-1020,
0x1.9860fa49120d2p-1020,
0x1.9713a1c341ef9p-1020,
0x1.98b693c7be681p-1020,
0x1.98dfde48ef088p-1020,
0x1.990928ca1fa8fp-1020,
0x1.9932734b50496p-1020,
0x1.9d2085d556d63p-1020,
0x1.9b2afece791cdp-1020,
0x1.9b54494fa9bd4p-1020,
0x1.9b7d93d0da5dbp-1020,
0x1.9a5985cc3ae09p-1020,
0x1.9bfc77d0b7591p-1020,
0x1.9a82d04d6b81p-1020,
0x1.9aac1ace9c217p-1020,
0x1.9c25c251e7f98p-1020,
0x1.9c4f0cd31899fp-1020,
0x1.9ccdf0d2f5955p-1020,
0x1.9cf73b542635cp-1020,
0x1.9d9f69d533d19p-1020,
0x1.9f425bd9b04a1p-1020,
0x1.9f6ba65ae0ea8p-1020,
0x1.9dc8b4566472p-1020,
0x1.9df1fed795127p-1020,
0x1.9f94f0dc118afp-1020,
0x1.9e70e2d7720ddp-1020,
0x1.a0e54dde2cc29p-1020,
0x1.a013d4dbee865p-1020,
0x1.9e9a2d58a2ae4p-1020,
0x1.a03d1f5d1f26cp-1020,
0x1.9ec377d9d34ebp-1020,
0x1.a06669de4fc73p-1020,
0x1.a2dad4e50a7bfp-1020,
0x1.a10e985f5d63p-1020,
0x1.a137e2e08e037p-1020,
0x1.a3306e63b6d6ep-1020,
0x1.a359b8e4e7775p-1020,
0x1.a1b6c6e06afedp-1020,
0x1.a38303661817cp-1020,
0x1.a1e011619b9f4p-1020,
0x1.a2095be2cc3fbp-1020,
0x1.a3ac4de748b83p-1020,
0x1.a2883fe2a93b1p-1020,
0x1.a401e765f5132p-1020,
0x1.a2b18a63d9db8p-1020,
0x1.a42b31e725b39p-1020,
0x1.a676526cafc7ep-1020,
0x1.a69f9cede0685p-1020,
0x1.a4547c685654p-1020,
0x1.a4d36068334f6p-1020,
0x1.a6c8e76f1108cp-1020,
0x1.a4fcaae963efdp-1020,
0x1.a525f56a94904p-1020,
0x1.a54f3febc530bp-1020,
0x1.a47dc6e986f47p-1020,
0x1.a5a4d96a718bap-1020,
0x1.a747cb6eee042p-1020,
0x1.a5ce23eba22c1p-1020,
0x1.a5f76e6cd2cc8p-1020,
0x1.a77115f01ea49p-1020,
0x1.a620b8ee036cfp-1020,
0x1.a79a60714f45p-1020,
0x1.aa8daf77e6f52p-1020,
0x1.a8eabd736a7cap-1020,
0x1.aab6f9f917959p-1020,
0x1.a91407f49b1d1p-1020,
0x1.a93d5275cbbd8p-1020,
0x1.aae0447a4836p-1020,
0x1.a81944712c406p-1020,
0x1.a9bc3675a8b8ep-1020,
0x1.a8428ef25ce0dp-1020,
0x1.a86bd9738d814p-1020,
0x1.a9e580f6d9595p-1020,
0x1.aa0ecb7809f9cp-1020,
0x1.ac59ebfd940e1p-1020,
0x1.ac83367ec4ae8p-1020,
0x1.ab5f287a25316p-1020,
0x1.ab8872fb55d1dp-1020,
0x1.ad2b64ffd24a5p-1020,
0x1.ad021a7ea1a9ep-1020,
0x1.abb1bd7c86724p-1020,
0x1.ad54af8102eacp-1020,
0x1.ac30a17c636dap-1020,
0x1.add39380dfe62p-1020,
0x1.adfcde0210869p-1020,
0x1.ae2628834127p-1020,
0x1.b01eb40669fa7p-1020,
0x1.b047fe879a9aep-1020,
0x1.aea50c831e226p-1020,
0x1.b0714908cb3b5p-1020,
0x1.aece57044ec2dp-1020,
0x1.b09a9389fbdbcp-1020,
0x1.aef7a1857f634p-1020,
0x1.b0f02d08a836bp-1020,
0x1.af7685855c5eap-1020,
0x1.b1197789d8d72p-1020,
0x1.af9fd0068cff1p-1020,
0x1.afc91a87bd9f8p-1020,
0x1.b142c20b09779p-1020,
0x1.b16c0c8c3a18p-1020,
0x1.b2143b0d47b3dp-1020,
0x1.b1c1a60ae672fp-1020,
0x1.b23d858e78544p-1020,
0x1.b1eaf08c17136p-1020,
0x1.b4361111a127bp-1020,
0x1.b2931f0d24af3p-1020,
0x1.b45f5b92d1c82p-1020,
0x1.b2bc698e554fap-1020,
0x1.b488a61402689p-1020,
0x1.b2e5b40f85f01p-1020,
0x1.b30efe90b6908p-1020,
0x1.b364980f62eb7p-1020,
0x1.b38de290938bep-1020,
0x1.b5078a13df63fp-1020,
0x1.b3b72d11c42c5p-1020,
0x1.b530d49510046p-1020,
0x1.b5d903161da03p-1020,
0x1.b6024d974e40ap-1020,
0x1.b62b98187ee11p-1020,
0x1.b55a1f1640a4dp-1020,
0x1.b6aa7c185bdc7p-1020,
0x1.b84d6e1cd854fp-1020,
0x1.b6d3c6998c7cep-1020,
0x1.b6fd111abd1d5p-1020,
0x1.b876b89e08f56p-1020,
0x1.b77bf51a9a18bp-1020,
0x1.b8a0031f3995dp-1020,
0x1.b7a53f9bcab92p-1020,
0x1.b7ce8a1cfb599p-1020,
0x1.bb935225d145fp-1020,
0x1.bbbc9ca701e66p-1020,
0x1.b9f0602154cd7p-1020,
0x1.ba19aaa2856dep-1020,
0x1.bbe5e7283286dp-1020,
0x1.ba42f523b60e5p-1020,
0x1.b91ee71f16913p-1020,
0x1.bac1d9239309bp-1020,
0x1.b94831a04731ap-1020,
0x1.b9717c2177d21p-1020,
0x1.baeb23a4c3aa2p-1020,
0x1.bb146e25f44a9p-1020,
0x1.bdde72ab5b5a4p-1020,
0x1.bc64cb280f823p-1020,
0x1.bc8e15a94022ap-1020,
0x1.be07bd2c8bfabp-1020,
0x1.be3107adbc9b2p-1020,
0x1.bcb7602a70c31p-1020,
0x1.be5a522eed3b9p-1020,
0x1.bd0cf9a91d1ep-1020,
0x1.beafebad99968p-1020,
0x1.bd36442a4dbe7p-1020,
0x1.bd5f8eab7e5eep-1020,
0x1.bed9362eca36fp-1020,
0x1.bd88d92caeff5p-1020,
0x1.bf0280affad76p-1020,
0x1.bf2bcb312b77dp-1020,
0x1.c14da13584ebbp-1020,
0x1.bf8164afd7d2cp-1020,
0x1.c176ebb6b58c2p-1020,
0x1.bfaaaf3108733p-1020,
0x1.bfd3f9b23913ap-1020,
0x1.bffd443369b41p-1020,
0x1.c052ddb2160fp-1020,
0x1.c1f5cfb692878p-1020,
0x1.c07c283346af7p-1020,
0x1.c21f1a37c327fp-1020,
0x1.c0a572b4774fep-1020,
0x1.c24864b8f3c86p-1020,
0x1.c12456b4544b4p-1020,
0x1.c2c748b8d0c3cp-1020,
0x1.c53bb3bf8b788p-1020,
0x1.c564fe40bc18fp-1020,
0x1.c398c1bb0fp-1020,
0x1.c58e48c1ecb96p-1020,
0x1.c3c20c3c3fa07p-1020,
0x1.c3eb56bd7040ep-1020,
0x1.c2f0933a01643p-1020,
0x1.c319ddbb3204ap-1020,
0x1.c46a3abd4d3c4p-1020,
0x1.c4bccfbfae7d2p-1020,
0x1.c493853e7ddcbp-1020,
0x1.c60d2cc1c9b4cp-1020,
0x1.c707f04538917p-1020,
0x1.c6367742fa553p-1020,
0x1.c7313ac66931ep-1020,
0x1.c65fc1c42af5ap-1020,
0x1.c7b01ec6462d4p-1020,
0x1.c7d9694776cdbp-1020,
0x1.c95310cac2a5cp-1020,
0x1.c802b3c8a76e2p-1020,
0x1.c97c5b4bf3463p-1020,
0x1.c6dea5c407f1p-1020,
0x1.c8aae249b509fp-1020,
0x1.c88197c884698p-1020,
0x1.c8d42ccae5aa6p-1020,
0x1.c9a5a5cd23e6ap-1020,
0x1.caccb84e0e7ddp-1020,
0x1.caf602cf3f1e4p-1020,
0x1.cceb89d61cd7ap-1020,
0x1.cb1f4d506fbebp-1020,
0x1.cb4897d1a05f2p-1020,
0x1.c9fb3f4bd0419p-1020,
0x1.ca2489cd00e2p-1020,
0x1.cb9e31504cba1p-1020,
0x1.ca4dd44e31827p-1020,
0x1.cbf0c652adfafp-1020,
0x1.ca771ecf6222ep-1020,
0x1.cbc77bd17d5a8p-1020,
0x1.cc1a10d3de9b6p-1020,
0x1.cc6faa528af65p-1020,
0x1.cc98f4d3bb96cp-1020,
0x1.ccc23f54ec373p-1020,
0x1.cd412354c9329p-1020,
0x1.cee4155945ab1p-1020,
0x1.cf0d5fda764b8p-1020,
0x1.cd6a6dd5f9d3p-1020,
0x1.cd93b8572a737p-1020,
0x1.cf36aa5ba6ebfp-1020,
0x1.ce3be6d8380f4p-1020,
0x1.ce129c57076edp-1020,
0x1.cfb58e5b83e75p-1020,
0x1.ce65315968afbp-1020,
0x1.cfded8dcb487cp-1020,
0x1.d008235de5283p-1020,
0x1.d087075dc2239p-1020,
0x1.d0b051def2c4p-1020,
0x1.d0d99c6023647p-1020,
0x1.d1588060005fdp-1020,
0x1.d2fb72647cd85p-1020,
0x1.d181cae131004p-1020,
0x1.d324bce5ad78cp-1020,
0x1.d1ab156261a0bp-1020,
0x1.d34e0766de193p-1020,
0x1.d229f9623e9c1p-1020,
0x1.d27c8e649fdcfp-1020,
0x1.d25343e36f3c8p-1020,
0x1.d641566d75c95p-1020,
0x1.d3cceb66bb149p-1020,
0x1.d66aa0eea669cp-1020,
0x1.d49e6468f950dp-1020,
0x1.d693eb6fd70a3p-1020,
0x1.d4c7aeea29f14p-1020,
0x1.d4f0f96b5a91bp-1020,
0x1.d3f635e7ebb5p-1020,
0x1.d41f80691c557p-1020,
0x1.d56fdd6b378d1p-1020,
0x1.d6e984ee83652p-1020,
0x1.d59927ec682d8p-1020,
0x1.d5c2726d98cdfp-1020,
0x1.d712cf6fb4059p-1020,
0x1.d73c19f0e4a6p-1020,
0x1.da2f68f77c562p-1020,
0x1.d88c76f2ffddap-1020,
0x1.d8b5c174307e1p-1020,
0x1.da58b378acf69p-1020,
0x1.d765647215467p-1020,
0x1.d8df0bf5611e8p-1020,
0x1.d908567691befp-1020,
0x1.da81fdf9dd97p-1020,
0x1.d7bafdf0c1a16p-1020,
0x1.d7e44871f241dp-1020,
0x1.d95deff53e19ep-1020,
0x1.d9873a766eba5p-1020,
0x1.d80d92f322e24p-1020,
0x1.d836dd745382bp-1020,
0x1.d9b084f79f5acp-1020,
0x1.dbfba57d296f1p-1020,
0x1.d9d9cf78cffb3p-1020,
0x1.dc24effe5a0f8p-1020,
0x1.db00e1f9ba926p-1020,
0x1.db2a2c7aeb32dp-1020,
0x1.dca3d3fe370aep-1020,
0x1.db5376fc1bd34p-1020,
0x1.dccd1e7f67ab5p-1020,
0x1.dcf66900984bcp-1020,
0x1.dbd25afbf8ceap-1020,
0x1.dd754d0075472p-1020,
0x1.dd9e9781a5e79p-1020,
0x1.ddc7e202d688p-1020,
0x1.dfe9b8072ffbep-1020,
0x1.de46c602b3836p-1020,
0x1.e0130288609c5p-1020,
0x1.de701083e423dp-1020,
0x1.e03c4d09913ccp-1020,
0x1.de995b0514c44p-1020,
0x1.df41898622601p-1020,
0x1.df183f04f1bfap-1020,
0x1.e0bb31096e382p-1020,
0x1.df6ad40753008p-1020,
0x1.e0e47b8a9ed89p-1020,
0x1.e10dc60bcf79p-1020,
0x1.e1df3f0e0db54p-1020,
0x1.e3d7ca913688bp-1020,
0x1.e25e230deab0ap-1020,
0x1.e401151267292p-1020,
0x1.e2876d8f1b511p-1020,
0x1.e42a5f9397c99p-1020,
0x1.e2b0b8104bf18p-1020,
0x1.e18caa0bac746p-1020,
0x1.e453aa14c86ap-1020,
0x1.e1b5f48cdd14dp-1020,
0x1.e32f9c1028ecep-1020,
0x1.e358e691598d5p-1020,
0x1.e38231128a2dcp-1020,
0x1.e4a9439374c4fp-1020,
0x1.e57abc95b3013p-1020,
0x1.e4d28e14a5656p-1020,
0x1.e5a40716e3a1ap-1020,
0x1.e5cd519814421p-1020,
0x1.e5f69c1944e28p-1020,
0x1.e4fbd895d605dp-1020,
0x1.e64c3597f13d7p-1020,
0x1.e675801921ddep-1020,
0x1.e525231706a64p-1020,
0x1.e6c8151b831ecp-1020,
0x1.e69eca9a527e5p-1020,
0x1.e7ef279c6db5fp-1020,
0x1.e71dae9a2f79bp-1020,
0x1.e746f91b601a2p-1020,
0x1.e818721d9e566p-1020,
0x1.e770439c90ba9p-1020,
0x1.eb350ba566a6fp-1020,
0x1.eb5e562697476p-1020,
0x1.e99219a0ea2e7p-1020,
0x1.e841bc9ecef6dp-1020,
0x1.e9bb64221aceep-1020,
0x1.e9e4aea34b6f5p-1020,
0x1.e8c0a09eabf23p-1020,
0x1.e8e9eb1fdc92ap-1020,
0x1.eb87a0a7c7e7dp-1020,
0x1.ea6392a3286abp-1020,
0x1.ea8cdd24590b2p-1020,
0x1.e91335a10d331p-1020,
0x1.eab627a589ab9p-1020,
0x1.ec0684a7a4e33p-1020,
0x1.eda976ac215bbp-1020,
0x1.ec2fcf28d583ap-1020,
0x1.edd2c12d51fc2p-1020,
0x1.ec5919aa06241p-1020,
0x1.edfc0bae829c9p-1020,
0x1.ecd7fda9e31f7p-1020,
0x1.ed01482b13bfep-1020,
0x1.ed2a92ac44605p-1020,
0x1.ee7aefae5f97fp-1020,
0x1.eea43a2f90386p-1020,
0x1.eecd84b0c0d8dp-1020,
0x1.f118a5364aed2p-1020,
0x1.ef4c68b09dd43p-1020,
0x1.f141efb77b8d9p-1020,
0x1.ef75b331ce74ap-1020,
0x1.ef9efdb2ff151p-1020,
0x1.f01de1b2dc107p-1020,
0x1.f197893627e88p-1020,
0x1.f1c0d3b75888fp-1020,
0x1.f0472c340cb0ep-1020,
0x1.f07076b53d515p-1020,
0x1.f1ea1e3889296p-1020,
0x1.f21368b9b9c9dp-1020,
0x1.f0c61033e9ac4p-1020,
0x1.f0ef5ab51a4cbp-1020,
0x1.f26902386624cp-1020,
0x1.f4dd6d3f20d98p-1020,
0x1.f506b7c05179fp-1020,
0x1.f33a7b3aa461p-1020,
0x1.f363c5bbd5017p-1020,
0x1.f5300241821a6p-1020,
0x1.f38d103d05a1ep-1020,
0x1.f3b65abe36425p-1020,
0x1.f2924cb996c53p-1020,
0x1.f2bb973ac765ap-1020,
0x1.f40bf43ce29d4p-1020,
0x1.f4353ebe133dbp-1020,
0x1.f2e4e1bbf8061p-1020,
0x1.f45e893f43de2p-1020,
0x1.f6d2f445fe92ep-1020,
0x1.f5aee6415f15cp-1020,
0x1.f5d830c28fb63p-1020,
0x1.f6017b43c056ap-1020,
0x1.f751d845db8e4p-1020,
0x1.f77b22c70c2ebp-1020,
0x1.f7a46d483ccf2p-1020,
0x1.f8f4ca4a5806cp-1020,
0x1.f6805f439d52p-1020,
0x1.f6a9a9c4cdf27p-1020,
0x1.f823514819ca8p-1020,
0x1.f84c9bc94a6afp-1020,
0x1.f875e64a7b0b6p-1020,
0x1.f91e14cb88a73p-1020,
0x1.fa97bc4ed47f4p-1020,
0x1.fac106d0051fbp-1020,
0x1.f9475f4cb947ap-1020,
0x1.faea515135c02p-1020,
0x1.f9c6434c9643p-1020,
0x1.f9ef8dcdc6e37p-1020,
0x1.fb69355112bb8p-1020,
0x1.fa18d84ef783ep-1020,
0x1.fb927fd2435bfp-1020,
0x1.fbbbca5373fc6p-1020,
0x1.fc3aae5350f7cp-1020,
0x1.fc63f8d481983p-1020,
0x1.fc8d4355b238ap-1020,
0x1.fe85ced8db0c1p-1020,
0x1.feaf195a0bac8p-1020,
0x1.fd0c27558f34p-1020,
0x1.fed863db3c4cfp-1020,
0x1.fd3571d6bfd47p-1020,
0x1.ff01ae5c6ced6p-1020,
0x1.fd5ebc57f074ep-1020,
0x1.fdb455d69ccfdp-1020,
0x1.fddda057cd704p-1020,
0x1.fe06ead8fe10bp-1020,
0x1.ff5747db19485p-1020,
0x1.fe30355a2eb12p-1020,
0x1.ff80925c49e8cp-1020,
0x1.ffa9dcdd7a893p-1020,
0x1.ffd3275eab29ap-1020,
};

/* check worst cases in [2^-1020, 2^-109) from those for the
   binade 2^-1020 <= x < 2^-1019 */
static void
check_tiny (void)
{
  for (int i = 0; i < N_WORST; i++)
  {
    double x = T[i];
    for (int e = -1019; e <= -110; e++)
    {
      // check binade 2^(e-1) <= |x| < 2^e
      check (ldexp (x, e + 1019));
      check (ldexp (-x, e + 1019));
    }
  }
}

int
main (int argc, char *argv[])
{
  while (argc >= 2)
    {
      if (strcmp (argv[1], "--rndn") == 0)
        {
          rnd = 0;
          argc --;
          argv ++;
        }
      else if (strcmp (argv[1], "--rndz") == 0)
        {
          rnd = 1;
          argc --;
          argv ++;
        }
      else if (strcmp (argv[1], "--rndu") == 0)
        {
          rnd = 2;
          argc --;
          argv ++;
        }
      else if (strcmp (argv[1], "--rndd") == 0)
        {
          rnd = 3;
          argc --;
          argv ++;
        }
      else if (strcmp (argv[1], "--verbose") == 0)
        {
          verbose = 1;
          argc --;
          argv ++;
        }
      else
        {
          fprintf (stderr, "Error, unknown option %s\n", argv[1]);
          exit (1);
        }
    }
  ref_init ();
  ref_fesetround (rnd);

#define N 1000000UL /* total number of tests */

  unsigned int seed = getpid ();
  srand (seed);

#pragma omp parallel for
  for (uint64_t n = 0; n < N; n++)
  {
    ref_init ();
    ref_fesetround (rnd);
    double x;
    do x = get_random (); while (x <= -1.0);
    check (x);
  }

  printf ("Checking tiny worst cases\n");
  check_tiny ();

  return 0;
}
